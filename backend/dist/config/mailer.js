import nodemailer from 'nodemailer';
import getSecrets from './sops.js';
async function createTransporter() {
	const secrets = await getSecrets.getSecrets();
	const transporter = nodemailer.createTransport({
		host: secrets.EMAIL_HOST,
		port: secrets.EMAIL_PORT,
		secure: secrets.EMAIL_SECURE,
		auth: {
			user: process.env.EMAIL_USER,
			pass: secrets.SMTP_TOKEN
		}
	});
	return transporter;
}
let transporter = null;
async function getTransporter() {
	if (!transporter) {
		transporter = await createTransporter();
	}
	return transporter;
}
export { createTransporter, getTransporter };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbmZpZy9tYWlsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxVQUEyQixNQUFNLFlBQVksQ0FBQztBQUNyRCxPQUFPLFVBQVUsTUFBTSxRQUFRLENBQUM7QUFTaEMsS0FBSyxVQUFVLGlCQUFpQjtJQUMvQixNQUFNLE9BQU8sR0FBa0IsTUFBTSxVQUFVLENBQUMsVUFBVSxFQUFFLENBQUM7SUFFN0QsSUFBSSxXQUFXLEdBQUcsVUFBVSxDQUFDLGVBQWUsQ0FBQztRQUM1QyxJQUFJLEVBQUUsT0FBTyxDQUFDLFVBQVU7UUFDeEIsSUFBSSxFQUFFLE9BQU8sQ0FBQyxVQUFVO1FBQ3hCLE1BQU0sRUFBRSxPQUFPLENBQUMsWUFBWTtRQUM1QixJQUFJLEVBQUU7WUFDTCxJQUFJLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFvQjtZQUN0QyxJQUFJLEVBQUUsT0FBTyxDQUFDLFVBQVU7U0FDeEI7S0FDRCxDQUFDLENBQUM7SUFFSCxPQUFPLFdBQVcsQ0FBQztBQUNwQixDQUFDO0FBRUQsSUFBSSxXQUFXLEdBQXVCLElBQUksQ0FBQztBQUUzQyxLQUFLLFVBQVUsY0FBYztJQUM1QixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDbEIsV0FBVyxHQUFHLE1BQU0saUJBQWlCLEVBQUUsQ0FBQztJQUN6QyxDQUFDO0lBQ0QsT0FBTyxXQUFXLENBQUM7QUFDcEIsQ0FBQztBQUVELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxjQUFjLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBub2RlbWFpbGVyLCB7IFRyYW5zcG9ydGVyIH0gZnJvbSAnbm9kZW1haWxlcic7XG5pbXBvcnQgZ2V0U2VjcmV0cyBmcm9tICcuL3NvcHMnO1xuXG5pbnRlcmZhY2UgTWFpbGVyU2VjcmV0cyB7XG5cdEVNQUlMX0hPU1Q6IHN0cmluZztcblx0RU1BSUxfUE9SVDogbnVtYmVyO1xuXHRFTUFJTF9TRUNVUkU6IGJvb2xlYW47XG5cdFNNVFBfVE9LRU46IHN0cmluZztcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVHJhbnNwb3J0ZXIoKTogUHJvbWlzZTxUcmFuc3BvcnRlcj4ge1xuXHRjb25zdCBzZWNyZXRzOiBNYWlsZXJTZWNyZXRzID0gYXdhaXQgZ2V0U2VjcmV0cy5nZXRTZWNyZXRzKCk7XG5cblx0bGV0IHRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuXHRcdGhvc3Q6IHNlY3JldHMuRU1BSUxfSE9TVCxcblx0XHRwb3J0OiBzZWNyZXRzLkVNQUlMX1BPUlQsXG5cdFx0c2VjdXJlOiBzZWNyZXRzLkVNQUlMX1NFQ1VSRSxcblx0XHRhdXRoOiB7XG5cdFx0XHR1c2VyOiBwcm9jZXNzLmVudi5FTUFJTF9VU0VSIGFzIHN0cmluZyxcblx0XHRcdHBhc3M6IHNlY3JldHMuU01UUF9UT0tFTlxuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIHRyYW5zcG9ydGVyO1xufVxuXG5sZXQgdHJhbnNwb3J0ZXI6IFRyYW5zcG9ydGVyIHwgbnVsbCA9IG51bGw7XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFRyYW5zcG9ydGVyKCk6IFByb21pc2U8VHJhbnNwb3J0ZXI+IHtcblx0aWYgKCF0cmFuc3BvcnRlcikge1xuXHRcdHRyYW5zcG9ydGVyID0gYXdhaXQgY3JlYXRlVHJhbnNwb3J0ZXIoKTtcblx0fVxuXHRyZXR1cm4gdHJhbnNwb3J0ZXI7XG59XG5cbmV4cG9ydCB7IGNyZWF0ZVRyYW5zcG9ydGVyLCBnZXRUcmFuc3BvcnRlciB9O1xuIl19
