import argon2 from 'argon2';
import { processError } from '../utils/processError.mjs';
import { validateDependencies } from '../utils/validateDependencies.mjs';
export const hashConfig = {
	type: argon2.argon2id,
	memoryCost: 48640, // 47.5 MiB memory
	timeCost: 4, // 4 iterations
	parallelism: 1
};
export async function hashPassword({ password, secrets, logger }) {
	try {
		validateDependencies(
			[
				{ name: 'password', instance: password },
				{ name: 'secrets', instance: secrets }
			],
			logger || console
		);
		return await argon2.hash(password + secrets.PEPPER, hashConfig);
	} catch (error) {
		processError(error, logger || console);
		return '';
	}
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFzaENvbmZpZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb25maWcvaGFzaENvbmZpZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLE1BQU0sTUFBTSxRQUFRLENBQUM7QUFFNUIsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRXJELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBVXJFLE1BQU0sQ0FBQyxNQUFNLFVBQVUsR0FBRztJQUN6QixJQUFJLEVBQUUsTUFBTSxDQUFDLFFBQVE7SUFDckIsVUFBVSxFQUFFLEtBQUssRUFBRSxrQkFBa0I7SUFDckMsUUFBUSxFQUFFLENBQUMsRUFBRSxlQUFlO0lBQzVCLFdBQVcsRUFBRSxDQUFDO0NBQ2QsQ0FBQztBQUVGLE1BQU0sQ0FBQyxLQUFLLFVBQVUsWUFBWSxDQUFDLEVBQ2xDLFFBQVEsRUFDUixPQUFPLEVBQ1AsTUFBTSxFQUNvQjtJQUMxQixJQUFJLENBQUM7UUFDSixvQkFBb0IsQ0FDbkI7WUFDQyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRTtZQUN4QyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRTtTQUN0QyxFQUNELE1BQU0sSUFBSSxPQUFPLENBQ2pCLENBQUM7UUFDRixPQUFPLE1BQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNoQixZQUFZLENBQUMsS0FBSyxFQUFFLE1BQU0sSUFBSSxPQUFPLENBQUMsQ0FBQztRQUN2QyxPQUFPLEVBQUUsQ0FBQztJQUNYLENBQUM7QUFDRixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFyZ29uMiBmcm9tICdhcmdvbjInO1xuaW1wb3J0IHsgTG9nZ2VyIH0gZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgcHJvY2Vzc0Vycm9yIH0gZnJvbSAnLi4vdXRpbHMvcHJvY2Vzc0Vycm9yJztcbmltcG9ydCB7IFNlY3JldHNNYXAgfSBmcm9tICcuLi91dGlscy9zb3BzJztcbmltcG9ydCB7IHZhbGlkYXRlRGVwZW5kZW5jaWVzIH0gZnJvbSAnLi4vdXRpbHMvdmFsaWRhdGVEZXBlbmRlbmNpZXMnO1xuXG50eXBlIFVzZXJTZWNyZXRzID0gUGljazxTZWNyZXRzTWFwLCAnUEVQUEVSJz47XG5cbmludGVyZmFjZSBIYXNoUGFzc3dvcmREZXBlbmRlbmNpZXMge1xuXHRwYXNzd29yZDogc3RyaW5nO1xuXHRzZWNyZXRzOiBVc2VyU2VjcmV0cztcblx0bG9nZ2VyOiBMb2dnZXI7XG59XG5cbmV4cG9ydCBjb25zdCBoYXNoQ29uZmlnID0ge1xuXHR0eXBlOiBhcmdvbjIuYXJnb24yaWQsXG5cdG1lbW9yeUNvc3Q6IDQ4NjQwLCAvLyA0Ny41IE1pQiBtZW1vcnlcblx0dGltZUNvc3Q6IDQsIC8vIDQgaXRlcmF0aW9uc1xuXHRwYXJhbGxlbGlzbTogMVxufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc2hQYXNzd29yZCh7XG5cdHBhc3N3b3JkLFxuXHRzZWNyZXRzLFxuXHRsb2dnZXJcbn06IEhhc2hQYXNzd29yZERlcGVuZGVuY2llcyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdHRyeSB7XG5cdFx0dmFsaWRhdGVEZXBlbmRlbmNpZXMoXG5cdFx0XHRbXG5cdFx0XHRcdHsgbmFtZTogJ3Bhc3N3b3JkJywgaW5zdGFuY2U6IHBhc3N3b3JkIH0sXG5cdFx0XHRcdHsgbmFtZTogJ3NlY3JldHMnLCBpbnN0YW5jZTogc2VjcmV0cyB9XG5cdFx0XHRdLFxuXHRcdFx0bG9nZ2VyIHx8IGNvbnNvbGVcblx0XHQpO1xuXHRcdHJldHVybiBhd2FpdCBhcmdvbjIuaGFzaChwYXNzd29yZCArIHNlY3JldHMuUEVQUEVSLCBoYXNoQ29uZmlnKTtcblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRwcm9jZXNzRXJyb3IoZXJyb3IsIGxvZ2dlciB8fCBjb25zb2xlKTtcblx0XHRyZXR1cm4gJyc7XG5cdH1cbn1cbiJdfQ==
