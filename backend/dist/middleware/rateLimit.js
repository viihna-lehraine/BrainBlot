import { RateLimiterMemory } from 'rate-limiter-flexible';
const rateLimiter = new RateLimiterMemory({
	points: 100, // 100 requests
	duration: 60, // per 60 seconds, by IP
	keyPrefix: 'rateLimiter' // useful for distinguishing rate limiters in logs or in distributed setups
});
export const rateLimitMiddleware = (req, res, next) => {
	let ip = req.ip || 'unknown'; // provides fallback if req.ip is undefined
	rateLimiter
		.consume(ip)
		.then(() => {
			next();
		})
		.catch(() => {
			res.status(429).send('Too many requests');
		});
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmF0ZUxpbWl0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21pZGRsZXdhcmUvcmF0ZUxpbWl0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRTFELE1BQU0sV0FBVyxHQUFHLElBQUksaUJBQWlCLENBQUM7SUFDekMsTUFBTSxFQUFFLEdBQUcsRUFBRSxlQUFlO0lBQzVCLFFBQVEsRUFBRSxFQUFFLEVBQUUsd0JBQXdCO0lBQ3RDLFNBQVMsRUFBRSxhQUFhLENBQUMsMkVBQTJFO0NBQ3BHLENBQUMsQ0FBQztBQUVILE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFHLENBQ2xDLEdBQVksRUFDWixHQUFhLEVBQ2IsSUFBa0IsRUFDakIsRUFBRTtJQUNILElBQUksRUFBRSxHQUFHLEdBQUcsQ0FBQyxFQUFFLElBQUksU0FBUyxDQUFDLENBQUMsMkNBQTJDO0lBRXpFLFdBQVc7U0FDVCxPQUFPLENBQUMsRUFBRSxDQUFDO1NBQ1gsSUFBSSxDQUFDLEdBQUcsRUFBRTtRQUNWLElBQUksRUFBRSxDQUFDO0lBQ1IsQ0FBQyxDQUFDO1NBQ0QsS0FBSyxDQUFDLEdBQUcsRUFBRTtRQUNYLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFDM0MsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0RnVuY3Rpb24sIFJlcXVlc3QsIFJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyBSYXRlTGltaXRlck1lbW9yeSB9IGZyb20gJ3JhdGUtbGltaXRlci1mbGV4aWJsZSc7XG5cbmNvbnN0IHJhdGVMaW1pdGVyID0gbmV3IFJhdGVMaW1pdGVyTWVtb3J5KHtcblx0cG9pbnRzOiAxMDAsIC8vIDEwMCByZXF1ZXN0c1xuXHRkdXJhdGlvbjogNjAsIC8vIHBlciA2MCBzZWNvbmRzLCBieSBJUFxuXHRrZXlQcmVmaXg6ICdyYXRlTGltaXRlcicgLy8gdXNlZnVsIGZvciBkaXN0aW5ndWlzaGluZyByYXRlIGxpbWl0ZXJzIGluIGxvZ3Mgb3IgaW4gZGlzdHJpYnV0ZWQgc2V0dXBzXG59KTtcblxuZXhwb3J0IGNvbnN0IHJhdGVMaW1pdE1pZGRsZXdhcmUgPSAoXG5cdHJlcTogUmVxdWVzdCxcblx0cmVzOiBSZXNwb25zZSxcblx0bmV4dDogTmV4dEZ1bmN0aW9uXG4pID0+IHtcblx0bGV0IGlwID0gcmVxLmlwIHx8ICd1bmtub3duJzsgLy8gcHJvdmlkZXMgZmFsbGJhY2sgaWYgcmVxLmlwIGlzIHVuZGVmaW5lZFxuXG5cdHJhdGVMaW1pdGVyXG5cdFx0LmNvbnN1bWUoaXApXG5cdFx0LnRoZW4oKCkgPT4ge1xuXHRcdFx0bmV4dCgpO1xuXHRcdH0pXG5cdFx0LmNhdGNoKCgpID0+IHtcblx0XHRcdHJlcy5zdGF0dXMoNDI5KS5zZW5kKCdUb28gbWFueSByZXF1ZXN0cycpO1xuXHRcdH0pO1xufTtcbiJdfQ==
