export const createPassportAuthMiddleware = ({
	passport,
	authenticateOptions
}) => {
	return (req, res, next) => {
		passport.authenticate('jwt', authenticateOptions, (err, user) => {
			if (err || !user) {
				return res.status(401).json({ error: 'Unauthorized' });
			}
			req.user = user;
			return next();
		})(req, res, next);
	};
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc3BvcnRBdXRoTWlkZGxld2FyZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL3Bhc3Nwb3J0QXV0aE1pZGRsZXdhcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBUUEsTUFBTSxDQUFDLE1BQU0sNEJBQTRCLEdBQUcsQ0FBQyxFQUM1QyxRQUFRLEVBQ1IsbUJBQW1CLEVBQ2lCLEVBQUUsRUFBRTtJQUN4QyxPQUFPLENBQUMsR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFRLEVBQUU7UUFDaEUsUUFBUSxDQUFDLFlBQVksQ0FDcEIsS0FBSyxFQUNMLG1CQUFtQixFQUNuQixDQUFDLEdBQWlCLEVBQUUsSUFBMEIsRUFBRSxFQUFFO1lBQ2pELElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7Z0JBQ2xCLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQztZQUN4RCxDQUFDO1lBQ0QsR0FBRyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7WUFDaEIsT0FBTyxJQUFJLEVBQUUsQ0FBQztRQUNmLENBQUMsQ0FDRCxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDbkIsQ0FBQyxDQUFDO0FBQ0gsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEZ1bmN0aW9uLCBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgQXV0aGVudGljYXRlT3B0aW9ucywgUGFzc3BvcnRTdGF0aWMgfSBmcm9tICdwYXNzcG9ydCc7XG5cbmludGVyZmFjZSBQYXNzcG9ydEF1dGhNaWRkbGV3YXJlRGVwZW5kZW5jaWVzIHtcblx0cGFzc3BvcnQ6IFBhc3Nwb3J0U3RhdGljO1xuXHRhdXRoZW50aWNhdGVPcHRpb25zOiBBdXRoZW50aWNhdGVPcHRpb25zO1xufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlUGFzc3BvcnRBdXRoTWlkZGxld2FyZSA9ICh7XG5cdHBhc3Nwb3J0LFxuXHRhdXRoZW50aWNhdGVPcHRpb25zXG59OiBQYXNzcG9ydEF1dGhNaWRkbGV3YXJlRGVwZW5kZW5jaWVzKSA9PiB7XG5cdHJldHVybiAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pOiB2b2lkID0+IHtcblx0XHRwYXNzcG9ydC5hdXRoZW50aWNhdGUoXG5cdFx0XHQnand0Jyxcblx0XHRcdGF1dGhlbnRpY2F0ZU9wdGlvbnMsXG5cdFx0XHQoZXJyOiBFcnJvciB8IG51bGwsIHVzZXI6IEV4cHJlc3MuVXNlciB8IGZhbHNlKSA9PiB7XG5cdFx0XHRcdGlmIChlcnIgfHwgIXVzZXIpIHtcblx0XHRcdFx0XHRyZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmVxLnVzZXIgPSB1c2VyO1xuXHRcdFx0XHRyZXR1cm4gbmV4dCgpO1xuXHRcdFx0fVxuXHRcdCkocmVxLCByZXMsIG5leHQpO1xuXHR9O1xufTtcbiJdfQ==
