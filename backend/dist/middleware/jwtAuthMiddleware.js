import { verifyJwToken } from '../utils/auth/jwtUtil.js';
export const authenticateJwT = async (req, res, next) => {
	const token = req.headers.authorization?.split(' ')[1];
	if (!token) {
		res.sendStatus(403);
		return;
	}
	let user = await verifyJwToken(token);
	if (!user) {
		res.sendStatus(403);
		return;
	}
	req.user = user;
	next();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiand0QXV0aE1pZGRsZXdhcmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbWlkZGxld2FyZS9qd3RBdXRoTWlkZGxld2FyZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFdEQsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFHLEtBQUssRUFDbkMsR0FBWSxFQUNaLEdBQWEsRUFDYixJQUFrQixFQUNGLEVBQUU7SUFDbEIsTUFBTSxLQUFLLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRXZELElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNaLEdBQUcsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEIsT0FBTztJQUNSLENBQUM7SUFFRCxJQUFJLElBQUksR0FBRyxNQUFNLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUV0QyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDWCxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BCLE9BQU87SUFDUixDQUFDO0lBRUQsR0FBRyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7SUFDaEIsSUFBSSxFQUFFLENBQUM7QUFDUixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0RnVuY3Rpb24sIFJlcXVlc3QsIFJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgeyB2ZXJpZnlKd1Rva2VuIH0gZnJvbSAnLi4vdXRpbHMvYXV0aC9qd3RVdGlsJztcblxuZXhwb3J0IGNvbnN0IGF1dGhlbnRpY2F0ZUp3VCA9IGFzeW5jIChcblx0cmVxOiBSZXF1ZXN0LFxuXHRyZXM6IFJlc3BvbnNlLFxuXHRuZXh0OiBOZXh0RnVuY3Rpb25cbik6IFByb21pc2U8dm9pZD4gPT4ge1xuXHRjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24/LnNwbGl0KCcgJylbMV07XG5cblx0aWYgKCF0b2tlbikge1xuXHRcdHJlcy5zZW5kU3RhdHVzKDQwMyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IHVzZXIgPSBhd2FpdCB2ZXJpZnlKd1Rva2VuKHRva2VuKTtcblxuXHRpZiAoIXVzZXIpIHtcblx0XHRyZXMuc2VuZFN0YXR1cyg0MDMpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdHJlcS51c2VyID0gdXNlcjtcblx0bmV4dCgpO1xufTtcbiJdfQ==
