import passport from 'passport';
export const authenticate = (req, res, next) => {
	passport.authenticate('jwt', { session: false }, (err, user) => {
		if (err || !user) {
			return res.status(401).json({ error: 'Unauthorized' });
		}
		req.user = user;
		return next;
	})(req, res, next);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc3BvcnRBdXRoTWlkZGxld2FyZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL3Bhc3Nwb3J0QXV0aE1pZGRsZXdhcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxRQUFpQyxNQUFNLFVBQVUsQ0FBQztBQUV6RCxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsQ0FDM0IsR0FBWSxFQUNaLEdBQWEsRUFDYixJQUFrQixFQUNYLEVBQUU7SUFDVCxRQUFRLENBQUMsWUFBWSxDQUNwQixLQUFLLEVBQ0wsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUF5QixFQUN6QyxDQUFDLEdBQWlCLEVBQUUsSUFBMEIsRUFBRSxFQUFFO1FBQ2pELElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDbEIsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxjQUFjLEVBQUUsQ0FBQyxDQUFDO1FBQ3hELENBQUM7UUFDRCxHQUFHLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNoQixPQUFPLElBQUksQ0FBQztJQUNiLENBQUMsQ0FDRCxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDbkIsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEZ1bmN0aW9uLCBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHBhc3Nwb3J0LCB7IEF1dGhlbnRpY2F0ZU9wdGlvbnMgfSBmcm9tICdwYXNzcG9ydCc7XG5cbmV4cG9ydCBjb25zdCBhdXRoZW50aWNhdGUgPSAoXG5cdHJlcTogUmVxdWVzdCxcblx0cmVzOiBSZXNwb25zZSxcblx0bmV4dDogTmV4dEZ1bmN0aW9uXG4pOiB2b2lkID0+IHtcblx0cGFzc3BvcnQuYXV0aGVudGljYXRlKFxuXHRcdCdqd3QnLFxuXHRcdHsgc2Vzc2lvbjogZmFsc2UgfSBhcyBBdXRoZW50aWNhdGVPcHRpb25zLFxuXHRcdChlcnI6IEVycm9yIHwgbnVsbCwgdXNlcjogRXhwcmVzcy5Vc2VyIHwgZmFsc2UpID0+IHtcblx0XHRcdGlmIChlcnIgfHwgIXVzZXIpIHtcblx0XHRcdFx0cmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xuXHRcdFx0fVxuXHRcdFx0cmVxLnVzZXIgPSB1c2VyO1xuXHRcdFx0cmV0dXJuIG5leHQ7XG5cdFx0fVxuXHQpKHJlcSwgcmVzLCBuZXh0KTtcbn07XG4iXX0=
