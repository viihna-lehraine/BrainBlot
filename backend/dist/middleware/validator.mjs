export function createValidatorMiddleware({ validator }) {
	const validateEntry = (req, res, next) => {
		const errors = [];
		// name validation
		if (validator.isEmpty(req.body.name || '')) {
			errors.push({ msg: 'Name is required', param: 'name' });
		}
		// message validation
		if (validator.isEmpty(req.body.message || '')) {
			errors.push({ msg: 'Message is required', param: 'message' });
		}
		if (errors.length) {
			res.status(400).json({ errors });
			return;
		}
		next();
	};
	const registrationValidationRules = (req, res, next) => {
		const errors = [];
		// username validation
		if (!validator.isLength(req.body.username || '', { min: 3 })) {
			errors.push({
				msg: 'Username must be at least 3 characters long',
				param: 'username'
			});
		}
		if (!validator.matches(req.body.username || '', /^[\w-]+$/)) {
			errors.push({
				msg: 'Username can only contain letters, numbers, underscores, and hyphens',
				param: 'username'
			});
		}
		// email validation
		if (!validator.isEmail(req.body.email || '')) {
			errors.push({
				msg: 'Please provide a valid email address',
				param: 'email'
			});
		}
		// password validation
		if (!validator.isLength(req.body.password || '', { min: 8 })) {
			errors.push({
				msg: 'Password must be at least 8 characters long',
				param: 'password'
			});
		}
		if (!validator.matches(req.body.password || '', /[A-Z]/)) {
			errors.push({
				msg: 'Password must contain at least one uppercase letter',
				param: 'password'
			});
		}
		if (!validator.matches(req.body.password || '', /[a-z]/)) {
			errors.push({
				msg: 'Password must contain at least one lowercase letter',
				param: 'password'
			});
		}
		if (!validator.matches(req.body.password || '', /\d/)) {
			errors.push({
				msg: 'Password must contain at least one digit',
				param: 'password'
			});
		}
		if (!validator.matches(req.body.password || '', /[^\dA-Za-z]/)) {
			errors.push({
				msg: 'Password must contain at least one special character',
				param: 'password'
			});
		}
		// confirm password validation
		if (req.body.password !== req.body.confirmPassword) {
			errors.push({
				msg: 'Passwords do not match',
				param: 'confirmPassword'
			});
		}
		if (errors.length) {
			res.status(400).json({ errors });
			return;
		}
		next();
	};
	return {
		validateEntry,
		registrationValidationRules
	};
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21pZGRsZXdhcmUvdmFsaWRhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU9BLE1BQU0sVUFBVSx5QkFBeUIsQ0FBQyxFQUN6QyxTQUFTLEVBQ2M7SUFRdkIsTUFBTSxhQUFhLEdBQUcsQ0FDckIsR0FBWSxFQUNaLEdBQWEsRUFDYixJQUFrQixFQUNYLEVBQUU7UUFDVCxNQUFNLE1BQU0sR0FBMEMsRUFBRSxDQUFDO1FBRXpELGtCQUFrQjtRQUNsQixJQUFJLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQztZQUM1QyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLGtCQUFrQixFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQ3pELENBQUM7UUFFRCxxQkFBcUI7UUFDckIsSUFBSSxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUM7WUFDL0MsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsRUFBRSxxQkFBcUIsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUMvRCxDQUFDO1FBRUQsSUFBSSxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDbkIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1lBQ2pDLE9BQU87UUFDUixDQUFDO1FBRUQsSUFBSSxFQUFFLENBQUM7SUFDUixDQUFDLENBQUM7SUFFRixNQUFNLDJCQUEyQixHQUFHLENBQ25DLEdBQVksRUFDWixHQUFhLEVBQ2IsSUFBa0IsRUFDWCxFQUFFO1FBQ1QsTUFBTSxNQUFNLEdBQTBDLEVBQUUsQ0FBQztRQUV6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QU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNuQixHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7WUFDakMsT0FBTztRQUNSLENBQUM7UUFFRCxJQUFJLEVBQUUsQ0FBQztJQUNSLENBQUMsQ0FBQztJQUVGLE9BQU87UUFDTixhQUFhO1FBQ2IsMkJBQTJCO0tBQzNCLENBQUM7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEZ1bmN0aW9uLCBSZXF1ZXN0LCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHZhbGlkYXRvciBmcm9tICd2YWxpZGF0b3InO1xuXG5pbnRlcmZhY2UgVmFsaWRhdG9yRGVwZW5kZW5jaWVzIHtcblx0dmFsaWRhdG9yOiB0eXBlb2YgdmFsaWRhdG9yO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVmFsaWRhdG9yTWlkZGxld2FyZSh7XG5cdHZhbGlkYXRvclxufTogVmFsaWRhdG9yRGVwZW5kZW5jaWVzKToge1xuXHR2YWxpZGF0ZUVudHJ5OiAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHZvaWQ7XG5cdHJlZ2lzdHJhdGlvblZhbGlkYXRpb25SdWxlczogKFxuXHRcdHJlcTogUmVxdWVzdCxcblx0XHRyZXM6IFJlc3BvbnNlLFxuXHRcdG5leHQ6IE5leHRGdW5jdGlvblxuXHQpID0+IHZvaWQ7XG59IHtcblx0Y29uc3QgdmFsaWRhdGVFbnRyeSA9IChcblx0XHRyZXE6IFJlcXVlc3QsXG5cdFx0cmVzOiBSZXNwb25zZSxcblx0XHRuZXh0OiBOZXh0RnVuY3Rpb25cblx0KTogdm9pZCA9PiB7XG5cdFx0Y29uc3QgZXJyb3JzOiBBcnJheTx7IG1zZzogc3RyaW5nOyBwYXJhbTogc3RyaW5nIH0+ID0gW107XG5cblx0XHQvLyBuYW1lIHZhbGlkYXRpb25cblx0XHRpZiAodmFsaWRhdG9yLmlzRW1wdHkocmVxLmJvZHkubmFtZSB8fCAnJykpIHtcblx0XHRcdGVycm9ycy5wdXNoKHsgbXNnOiAnTmFtZSBpcyByZXF1aXJlZCcsIHBhcmFtOiAnbmFtZScgfSk7XG5cdFx0fVxuXG5cdFx0Ly8gbWVzc2FnZSB2YWxpZGF0aW9uXG5cdFx0aWYgKHZhbGlkYXRvci5pc0VtcHR5KHJlcS5ib2R5Lm1lc3NhZ2UgfHwgJycpKSB7XG5cdFx0XHRlcnJvcnMucHVzaCh7IG1zZzogJ01lc3NhZ2UgaXMgcmVxdWlyZWQnLCBwYXJhbTogJ21lc3NhZ2UnIH0pO1xuXHRcdH1cblxuXHRcdGlmIChlcnJvcnMubGVuZ3RoKSB7XG5cdFx0XHRyZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9ycyB9KTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRuZXh0KCk7XG5cdH07XG5cblx0Y29uc3QgcmVnaXN0cmF0aW9uVmFsaWRhdGlvblJ1bGVzID0gKFxuXHRcdHJlcTogUmVxdWVzdCxcblx0XHRyZXM6IFJlc3BvbnNlLFxuXHRcdG5leHQ6IE5leHRGdW5jdGlvblxuXHQpOiB2b2lkID0+IHtcblx0XHRjb25zdCBlcnJvcnM6IEFycmF5PHsgbXNnOiBzdHJpbmc7IHBhcmFtOiBzdHJpbmcgfT4gPSBbXTtcblxuXHRcdC8vIHVzZXJuYW1lIHZhbGlkYXRpb25cblx0XHRpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChyZXEuYm9keS51c2VybmFtZSB8fCAnJywgeyBtaW46IDMgfSkpIHtcblx0XHRcdGVycm9ycy5wdXNoKHtcblx0XHRcdFx0bXNnOiAnVXNlcm5hbWUgbXVzdCBiZSBhdCBsZWFzdCAzIGNoYXJhY3RlcnMgbG9uZycsXG5cdFx0XHRcdHBhcmFtOiAndXNlcm5hbWUnXG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0aWYgKCF2YWxpZGF0b3IubWF0Y2hlcyhyZXEuYm9keS51c2VybmFtZSB8fCAnJywgL15bXFx3LV0rJC8pKSB7XG5cdFx0XHRlcnJvcnMucHVzaCh7XG5cdFx0XHRcdG1zZzogJ1VzZXJuYW1lIGNhbiBvbmx5IGNvbnRhaW4gbGV0dGVycywgbnVtYmVycywgdW5kZXJzY29yZXMsIGFuZCBoeXBoZW5zJyxcblx0XHRcdFx0cGFyYW06ICd1c2VybmFtZSdcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIGVtYWlsIHZhbGlkYXRpb25cblx0XHRpZiAoIXZhbGlkYXRvci5pc0VtYWlsKHJlcS5ib2R5LmVtYWlsIHx8ICcnKSkge1xuXHRcdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0XHRtc2c6ICdQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIGVtYWlsIGFkZHJlc3MnLFxuXHRcdFx0XHRwYXJhbTogJ2VtYWlsJ1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly8gcGFzc3dvcmQgdmFsaWRhdGlvblxuXHRcdGlmICghdmFsaWRhdG9yLmlzTGVuZ3RoKHJlcS5ib2R5LnBhc3N3b3JkIHx8ICcnLCB7IG1pbjogOCB9KSkge1xuXHRcdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0XHRtc2c6ICdQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVycyBsb25nJyxcblx0XHRcdFx0cGFyYW06ICdwYXNzd29yZCdcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRpZiAoIXZhbGlkYXRvci5tYXRjaGVzKHJlcS5ib2R5LnBhc3N3b3JkIHx8ICcnLCAvW0EtWl0vKSkge1xuXHRcdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0XHRtc2c6ICdQYXNzd29yZCBtdXN0IGNvbnRhaW4gYXQgbGVhc3Qgb25lIHVwcGVyY2FzZSBsZXR0ZXInLFxuXHRcdFx0XHRwYXJhbTogJ3Bhc3N3b3JkJ1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGlmICghdmFsaWRhdG9yLm1hdGNoZXMocmVxLmJvZHkucGFzc3dvcmQgfHwgJycsIC9bYS16XS8pKSB7XG5cdFx0XHRlcnJvcnMucHVzaCh7XG5cdFx0XHRcdG1zZzogJ1Bhc3N3b3JkIG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgbG93ZXJjYXNlIGxldHRlcicsXG5cdFx0XHRcdHBhcmFtOiAncGFzc3dvcmQnXG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0aWYgKCF2YWxpZGF0b3IubWF0Y2hlcyhyZXEuYm9keS5wYXNzd29yZCB8fCAnJywgL1xcZC8pKSB7XG5cdFx0XHRlcnJvcnMucHVzaCh7XG5cdFx0XHRcdG1zZzogJ1Bhc3N3b3JkIG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgZGlnaXQnLFxuXHRcdFx0XHRwYXJhbTogJ3Bhc3N3b3JkJ1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGlmICghdmFsaWRhdG9yLm1hdGNoZXMocmVxLmJvZHkucGFzc3dvcmQgfHwgJycsIC9bXlxcZEEtWmEtel0vKSkge1xuXHRcdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0XHRtc2c6ICdQYXNzd29yZCBtdXN0IGNvbnRhaW4gYXQgbGVhc3Qgb25lIHNwZWNpYWwgY2hhcmFjdGVyJyxcblx0XHRcdFx0cGFyYW06ICdwYXNzd29yZCdcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vIGNvbmZpcm0gcGFzc3dvcmQgdmFsaWRhdGlvblxuXHRcdGlmIChyZXEuYm9keS5wYXNzd29yZCAhPT0gcmVxLmJvZHkuY29uZmlybVBhc3N3b3JkKSB7XG5cdFx0XHRlcnJvcnMucHVzaCh7XG5cdFx0XHRcdG1zZzogJ1Bhc3N3b3JkcyBkbyBub3QgbWF0Y2gnLFxuXHRcdFx0XHRwYXJhbTogJ2NvbmZpcm1QYXNzd29yZCdcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmIChlcnJvcnMubGVuZ3RoKSB7XG5cdFx0XHRyZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9ycyB9KTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRuZXh0KCk7XG5cdH07XG5cblx0cmV0dXJuIHtcblx0XHR2YWxpZGF0ZUVudHJ5LFxuXHRcdHJlZ2lzdHJhdGlvblZhbGlkYXRpb25SdWxlc1xuXHR9O1xufVxuIl19
