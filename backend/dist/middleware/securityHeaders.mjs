import helmet from 'helmet';
export function setupSecurityHeaders(
	app,
	{
		helmetOptions = {
			frameguard: { action: 'deny' },
			dnsPrefetchControl: { allow: false },
			hidePoweredBy: true,
			hsts: {
				maxAge: 31536000, // 1 year
				includeSubDomains: true,
				preload: true // enable HSTS preload list
			},
			ieNoOpen: true,
			noSniff: true
		},
		permissionsPolicyOptions = {
			fullscreen: ["'self'"],
			geolocation: ["'none'"],
			microphone: ["'none'"],
			camera: ["'none'"],
			payment: ["'none'"]
		}
	}
) {
	app.use(helmet(helmetOptions));
	app.use((req, res, next) => {
		const policies = Object.entries(permissionsPolicyOptions)
			.map(([feature, origins]) => `${feature} ${origins.join(' ')}`)
			.join(', ');
		res.setHeader('Permissions-Policy', policies);
		next();
	});
	app.use(
		helmet.contentSecurityPolicy({
			directives: {
				defaultSrc: ["'self'"],
				scriptSrc: ["'self'", 'https://api.haveibeenpwned.com'],
				styleSrc: ["'self'", "'unsafe-inline'"],
				fontSrc: ["'self'"],
				imgSrc: ["'self'", 'data:'],
				connectSrc: [
					"'self'",
					'https://api.haveibeenpwned.com',
					'https://cdnjs.cloudflare.com'
				],
				objectSrc: ["'none'"],
				upgradeInsecureRequests: [],
				frameAncestors: ["'none'"]
			},
			reportOnly: false
		})
	);
	// Enforce certificate transparency
	app.use((req, res, next) => {
		res.setHeader('Expect-CT', 'enforce, max-age=86400');
		next();
	});
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VjdXJpdHlIZWFkZXJzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21pZGRsZXdhcmUvc2VjdXJpdHlIZWFkZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sTUFBeUIsTUFBTSxRQUFRLENBQUM7QUFTL0MsTUFBTSxVQUFVLG9CQUFvQixDQUNuQyxHQUFnQixFQUNoQixFQUNDLGFBQWEsR0FBRztJQUNmLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUU7SUFDOUIsa0JBQWtCLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFO0lBQ3BDLGFBQWEsRUFBRSxJQUFJO0lBQ25CLElBQUksRUFBRTtRQUNMLE1BQU0sRUFBRSxRQUFRLEVBQUUsU0FBUztRQUMzQixpQkFBaUIsRUFBRSxJQUFJO1FBQ3ZCLE9BQU8sRUFBRSxJQUFJLENBQUMsMkJBQTJCO0tBQ3pDO0lBQ0QsUUFBUSxFQUFFLElBQUk7SUFDZCxPQUFPLEVBQUUsSUFBSTtDQUNiLEVBQ0Qsd0JBQXdCLEdBQUc7SUFDMUIsVUFBVSxFQUFFLENBQUMsUUFBUSxDQUFDO0lBQ3RCLFdBQVcsRUFBRSxDQUFDLFFBQVEsQ0FBQztJQUN2QixVQUFVLEVBQUUsQ0FBQyxRQUFRLENBQUM7SUFDdEIsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDO0lBQ2xCLE9BQU8sRUFBRSxDQUFDLFFBQVEsQ0FBQztDQUNuQixFQUM0QjtJQUU5QixHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO0lBRS9CLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFZLEVBQUUsR0FBYSxFQUFFLElBQWtCLEVBQUUsRUFBRTtRQUMzRCxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLHdCQUF3QixDQUFDO2FBQ3ZELEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxFQUFFLEVBQUUsQ0FBQyxHQUFHLE9BQU8sSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7YUFDOUQsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRWIsR0FBRyxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUM5QyxJQUFJLEVBQUUsQ0FBQztJQUNSLENBQUMsQ0FBQyxDQUFDO0lBRUgsR0FBRyxDQUFDLEdBQUcsQ0FDTixNQUFNLENBQUMscUJBQXFCLENBQUM7UUFDNUIsVUFBVSxFQUFFO1lBQ1gsVUFBVSxFQUFFLENBQUMsUUFBUSxDQUFDO1lBQ3RCLFNBQVMsRUFBRSxDQUFDLFFBQVEsRUFBRSxnQ0FBZ0MsQ0FBQztZQUN2RCxRQUFRLEVBQUUsQ0FBQyxRQUFRLEVBQUUsaUJBQWlCLENBQUM7WUFDdkMsT0FBTyxFQUFFLENBQUMsUUFBUSxDQUFDO1lBQ25CLE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUM7WUFDM0IsVUFBVSxFQUFFO2dCQUNYLFFBQVE7Z0JBQ1IsZ0NBQWdDO2dCQUNoQyw4QkFBOEI7YUFDOUI7WUFDRCxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUM7WUFDckIsdUJBQXVCLEVBQUUsRUFBRTtZQUMzQixjQUFjLEVBQUUsQ0FBQyxRQUFRLENBQUM7U0FDMUI7UUFDRCxVQUFVLEVBQUUsS0FBSztLQUNqQixDQUFDLENBQ0YsQ0FBQztJQUVGLG1DQUFtQztJQUNuQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBWSxFQUFFLEdBQWEsRUFBRSxJQUFrQixFQUFFLEVBQUU7UUFDM0QsR0FBRyxDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUUsd0JBQXdCLENBQUMsQ0FBQztRQUNyRCxJQUFJLEVBQUUsQ0FBQztJQUNSLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcGxpY2F0aW9uLCBOZXh0RnVuY3Rpb24sIFJlcXVlc3QsIFJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgaGVsbWV0LCB7IEhlbG1ldE9wdGlvbnMgfSBmcm9tICdoZWxtZXQnO1xuXG5pbnRlcmZhY2UgU2VjdXJpdHlIZWFkZXJzRGVwZW5kZW5jaWVzIHtcblx0aGVsbWV0T3B0aW9ucz86IEhlbG1ldE9wdGlvbnM7XG5cdHBlcm1pc3Npb25zUG9saWN5T3B0aW9ucz86IHtcblx0XHRba2V5OiBzdHJpbmddOiBzdHJpbmdbXTtcblx0fTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldHVwU2VjdXJpdHlIZWFkZXJzKFxuXHRhcHA6IEFwcGxpY2F0aW9uLFxuXHR7XG5cdFx0aGVsbWV0T3B0aW9ucyA9IHtcblx0XHRcdGZyYW1lZ3VhcmQ6IHsgYWN0aW9uOiAnZGVueScgfSxcblx0XHRcdGRuc1ByZWZldGNoQ29udHJvbDogeyBhbGxvdzogZmFsc2UgfSxcblx0XHRcdGhpZGVQb3dlcmVkQnk6IHRydWUsXG5cdFx0XHRoc3RzOiB7XG5cdFx0XHRcdG1heEFnZTogMzE1MzYwMDAsIC8vIDEgeWVhclxuXHRcdFx0XHRpbmNsdWRlU3ViRG9tYWluczogdHJ1ZSxcblx0XHRcdFx0cHJlbG9hZDogdHJ1ZSAvLyBlbmFibGUgSFNUUyBwcmVsb2FkIGxpc3Rcblx0XHRcdH0sXG5cdFx0XHRpZU5vT3BlbjogdHJ1ZSxcblx0XHRcdG5vU25pZmY6IHRydWVcblx0XHR9LFxuXHRcdHBlcm1pc3Npb25zUG9saWN5T3B0aW9ucyA9IHtcblx0XHRcdGZ1bGxzY3JlZW46IFtcIidzZWxmJ1wiXSxcblx0XHRcdGdlb2xvY2F0aW9uOiBbXCInbm9uZSdcIl0sXG5cdFx0XHRtaWNyb3Bob25lOiBbXCInbm9uZSdcIl0sXG5cdFx0XHRjYW1lcmE6IFtcIidub25lJ1wiXSxcblx0XHRcdHBheW1lbnQ6IFtcIidub25lJ1wiXVxuXHRcdH1cblx0fTogU2VjdXJpdHlIZWFkZXJzRGVwZW5kZW5jaWVzXG4pOiB2b2lkIHtcblx0YXBwLnVzZShoZWxtZXQoaGVsbWV0T3B0aW9ucykpO1xuXG5cdGFwcC51c2UoKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XG5cdFx0Y29uc3QgcG9saWNpZXMgPSBPYmplY3QuZW50cmllcyhwZXJtaXNzaW9uc1BvbGljeU9wdGlvbnMpXG5cdFx0XHQubWFwKChbZmVhdHVyZSwgb3JpZ2luc10pID0+IGAke2ZlYXR1cmV9ICR7b3JpZ2lucy5qb2luKCcgJyl9YClcblx0XHRcdC5qb2luKCcsICcpO1xuXG5cdFx0cmVzLnNldEhlYWRlcignUGVybWlzc2lvbnMtUG9saWN5JywgcG9saWNpZXMpO1xuXHRcdG5leHQoKTtcblx0fSk7XG5cblx0YXBwLnVzZShcblx0XHRoZWxtZXQuY29udGVudFNlY3VyaXR5UG9saWN5KHtcblx0XHRcdGRpcmVjdGl2ZXM6IHtcblx0XHRcdFx0ZGVmYXVsdFNyYzogW1wiJ3NlbGYnXCJdLFxuXHRcdFx0XHRzY3JpcHRTcmM6IFtcIidzZWxmJ1wiLCAnaHR0cHM6Ly9hcGkuaGF2ZWliZWVucHduZWQuY29tJ10sXG5cdFx0XHRcdHN0eWxlU3JjOiBbXCInc2VsZidcIiwgXCIndW5zYWZlLWlubGluZSdcIl0sXG5cdFx0XHRcdGZvbnRTcmM6IFtcIidzZWxmJ1wiXSxcblx0XHRcdFx0aW1nU3JjOiBbXCInc2VsZidcIiwgJ2RhdGE6J10sXG5cdFx0XHRcdGNvbm5lY3RTcmM6IFtcblx0XHRcdFx0XHRcIidzZWxmJ1wiLFxuXHRcdFx0XHRcdCdodHRwczovL2FwaS5oYXZlaWJlZW5wd25lZC5jb20nLFxuXHRcdFx0XHRcdCdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tJ1xuXHRcdFx0XHRdLFxuXHRcdFx0XHRvYmplY3RTcmM6IFtcIidub25lJ1wiXSxcblx0XHRcdFx0dXBncmFkZUluc2VjdXJlUmVxdWVzdHM6IFtdLFxuXHRcdFx0XHRmcmFtZUFuY2VzdG9yczogW1wiJ25vbmUnXCJdXG5cdFx0XHR9LFxuXHRcdFx0cmVwb3J0T25seTogZmFsc2Vcblx0XHR9KVxuXHQpO1xuXG5cdC8vIEVuZm9yY2UgY2VydGlmaWNhdGUgdHJhbnNwYXJlbmN5XG5cdGFwcC51c2UoKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XG5cdFx0cmVzLnNldEhlYWRlcignRXhwZWN0LUNUJywgJ2VuZm9yY2UsIG1heC1hZ2U9ODY0MDAnKTtcblx0XHRuZXh0KCk7XG5cdH0pO1xufVxuIl19
