import jwt from 'jsonwebtoken';
import setupLogger from '../../config/logger.js';
import getSecrets from '../../config/secrets.js';
const logger = await setupLogger();
const secrets = await getSecrets();
if (!secrets) {
	throw new Error('Secrets could not be loaded');
}
export const generateToken = async user => {
	return jwt.sign(
		{ id: user.id, username: user.username },
		secrets.JWT_SECRET,
		{ expiresIn: '1h' }
	);
};
export const verifyJwToken = async token => {
	try {
		return jwt.verify(token, secrets.JWT_SECRET);
	} catch (err) {
		logger.error(err);
		return null;
	}
};
export default verifyJwToken;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiand0VXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9hdXRoL2p3dFV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxHQUFHLE1BQU0sY0FBYyxDQUFDO0FBQy9CLE9BQU8sV0FBVyxNQUFNLHFCQUFxQixDQUFDO0FBQzlDLE9BQU8sVUFBVSxNQUFNLHNCQUFzQixDQUFDO0FBVzlDLE1BQU0sTUFBTSxHQUFHLE1BQU0sV0FBVyxFQUFFLENBQUM7QUFDbkMsTUFBTSxPQUFPLEdBQVksTUFBTSxVQUFVLEVBQUUsQ0FBQztBQUU1QyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDZCxNQUFNLElBQUksS0FBSyxDQUFDLDZCQUE2QixDQUFDLENBQUM7QUFDaEQsQ0FBQztBQUVELE1BQU0sQ0FBQyxNQUFNLGFBQWEsR0FBRyxLQUFLLEVBQUUsSUFBVSxFQUFtQixFQUFFO0lBQ2xFLE9BQU8sR0FBRyxDQUFDLElBQUksQ0FDZCxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQ3hDLE9BQU8sQ0FBQyxVQUFVLEVBQ2xCLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxDQUNuQixDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLE1BQU0sYUFBYSxHQUFHLEtBQUssRUFDakMsS0FBYSxFQUNxQixFQUFFO0lBQ3BDLElBQUksQ0FBQztRQUNKLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzlDLENBQUM7SUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2QsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNsQixPQUFPLElBQUksQ0FBQztJQUNiLENBQUM7QUFDRixDQUFDLENBQUM7QUFFRixlQUFlLGFBQWEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCBzZXR1cExvZ2dlciBmcm9tICcuLi8uLi9jb25maWcvbG9nZ2VyJztcbmltcG9ydCBnZXRTZWNyZXRzIGZyb20gJy4uLy4uL2NvbmZpZy9zZWNyZXRzJztcblxuaW50ZXJmYWNlIFNlY3JldHMge1xuXHRKV1RfU0VDUkVUOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBVc2VyIHtcblx0aWQ6IHN0cmluZztcblx0dXNlcm5hbWU6IHN0cmluZztcbn1cblxuY29uc3QgbG9nZ2VyID0gYXdhaXQgc2V0dXBMb2dnZXIoKTtcbmNvbnN0IHNlY3JldHM6IFNlY3JldHMgPSBhd2FpdCBnZXRTZWNyZXRzKCk7XG5cbmlmICghc2VjcmV0cykge1xuXHR0aHJvdyBuZXcgRXJyb3IoJ1NlY3JldHMgY291bGQgbm90IGJlIGxvYWRlZCcpO1xufVxuXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVUb2tlbiA9IGFzeW5jICh1c2VyOiBVc2VyKTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcblx0cmV0dXJuIGp3dC5zaWduKFxuXHRcdHsgaWQ6IHVzZXIuaWQsIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lIH0sXG5cdFx0c2VjcmV0cy5KV1RfU0VDUkVULFxuXHRcdHsgZXhwaXJlc0luOiAnMWgnIH1cblx0KTtcbn07XG5cbmV4cG9ydCBjb25zdCB2ZXJpZnlKd1Rva2VuID0gYXN5bmMgKFxuXHR0b2tlbjogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZyB8IG9iamVjdCB8IG51bGw+ID0+IHtcblx0dHJ5IHtcblx0XHRyZXR1cm4gand0LnZlcmlmeSh0b2tlbiwgc2VjcmV0cy5KV1RfU0VDUkVUKTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0bG9nZ2VyLmVycm9yKGVycik7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHZlcmlmeUp3VG9rZW47XG4iXX0=
