import jwt from 'jsonwebtoken';
import setupLogger from '../../config/logger';
import getSecrets from '../../config/sops';
const logger = setupLogger();
const secrets = await getSecrets.getSecrets();
export const generateToken = async user => {
	return jwt.sign(
		{ id: user.id, username: user.username },
		secrets.JWT_SECRET,
		{ expiresIn: '1h' }
	);
};
export const verifyJwToken = async token => {
	try {
		return jwt.verify(token, secrets.JWT_SECRET);
	} catch (err) {
		logger.error(err);
		return null;
	}
};
export default verifyJwToken;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiand0VXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy91dGlscy9hdXRoL2p3dFV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxHQUFHLE1BQU0sY0FBYyxDQUFDO0FBQy9CLE9BQU8sV0FBVyxNQUFNLHFCQUFxQixDQUFDO0FBQzlDLE9BQU8sVUFBVSxNQUFNLG1CQUFtQixDQUFDO0FBVzNDLE1BQU0sTUFBTSxHQUFHLFdBQVcsRUFBRSxDQUFDO0FBQzdCLE1BQU0sT0FBTyxHQUFZLE1BQU0sVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFDO0FBRXZELE1BQU0sQ0FBQyxNQUFNLGFBQWEsR0FBRyxLQUFLLEVBQUUsSUFBVSxFQUFtQixFQUFFO0lBQ2xFLE9BQU8sR0FBRyxDQUFDLElBQUksQ0FDZCxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQ3hDLE9BQU8sQ0FBQyxVQUFVLEVBQ2xCLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxDQUNuQixDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLE1BQU0sYUFBYSxHQUFHLEtBQUssRUFDakMsS0FBYSxFQUNxQixFQUFFO0lBQ3BDLElBQUksQ0FBQztRQUNKLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzlDLENBQUM7SUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2QsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNsQixPQUFPLElBQUksQ0FBQztJQUNiLENBQUM7QUFDRixDQUFDLENBQUM7QUFFRixlQUFlLGFBQWEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCBzZXR1cExvZ2dlciBmcm9tICcuLi8uLi9jb25maWcvbG9nZ2VyJztcbmltcG9ydCBnZXRTZWNyZXRzIGZyb20gJy4uLy4uL2NvbmZpZy9zb3BzJztcblxuaW50ZXJmYWNlIFNlY3JldHMge1xuXHRKV1RfU0VDUkVUOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBVc2VyIHtcblx0aWQ6IHN0cmluZztcblx0dXNlcm5hbWU6IHN0cmluZztcbn1cblxuY29uc3QgbG9nZ2VyID0gc2V0dXBMb2dnZXIoKTtcbmNvbnN0IHNlY3JldHM6IFNlY3JldHMgPSBhd2FpdCBnZXRTZWNyZXRzLmdldFNlY3JldHMoKTtcblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlVG9rZW4gPSBhc3luYyAodXNlcjogVXNlcik6IFByb21pc2U8c3RyaW5nPiA9PiB7XG5cdHJldHVybiBqd3Quc2lnbihcblx0XHR7IGlkOiB1c2VyLmlkLCB1c2VybmFtZTogdXNlci51c2VybmFtZSB9LFxuXHRcdHNlY3JldHMuSldUX1NFQ1JFVCxcblx0XHR7IGV4cGlyZXNJbjogJzFoJyB9XG5cdCk7XG59O1xuXG5leHBvcnQgY29uc3QgdmVyaWZ5SndUb2tlbiA9IGFzeW5jIChcblx0dG9rZW46IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmcgfCBvYmplY3QgfCBudWxsPiA9PiB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIGp3dC52ZXJpZnkodG9rZW4sIHNlY3JldHMuSldUX1NFQ1JFVCk7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGxvZ2dlci5lcnJvcihlcnIpO1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG59O1xuXG5leHBvcnQgZGVmYXVsdCB2ZXJpZnlKd1Rva2VuO1xuIl19
