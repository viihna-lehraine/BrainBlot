import speakeasy from 'speakeasy';
import QRCode from 'qrcode';
function generateTOTPSecret() {
	const totpSecret = speakeasy.generateSecret({ length: 20 });
	return {
		ascii: totpSecret.ascii || '',
		hex: totpSecret.hex || '',
		base32: totpSecret.base32 || '',
		otpauth_url: totpSecret.otpauth_url || ''
	};
}
function generateTOTPToken(secret) {
	const totpToken = speakeasy.totp({
		secret,
		encoding: 'base32'
	});
	return totpToken;
}
function verifyTOTPToken(secret, token) {
	const isTOTPTokenValid = speakeasy.totp.verify({
		secret,
		encoding: 'base32',
		token,
		window: 1 // gives leeway for clock drift
	});
	return isTOTPTokenValid;
}
async function generateQRCode(otpauth_url) {
	return await QRCode.toDataURL(otpauth_url);
}
export {
	generateTOTPSecret,
	generateTOTPToken,
	verifyTOTPToken,
	generateQRCode
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG90cFV0aWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdXRpbHMvYXV0aC90b3RwVXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLFNBQVMsTUFBTSxXQUFXLENBQUM7QUFDbEMsT0FBTyxNQUFNLE1BQU0sUUFBUSxDQUFDO0FBUzVCLFNBQVMsa0JBQWtCO0lBQzFCLE1BQU0sVUFBVSxHQUFHLFNBQVMsQ0FBQyxjQUFjLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM1RCxPQUFPO1FBQ04sS0FBSyxFQUFFLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUM3QixHQUFHLEVBQUUsVUFBVSxDQUFDLEdBQUcsSUFBSSxFQUFFO1FBQ3pCLE1BQU0sRUFBRSxVQUFVLENBQUMsTUFBTSxJQUFJLEVBQUU7UUFDL0IsV0FBVyxFQUFFLFVBQVUsQ0FBQyxXQUFXLElBQUksRUFBRTtLQUN6QyxDQUFDO0FBQ0gsQ0FBQztBQUVELFNBQVMsaUJBQWlCLENBQUMsTUFBYztJQUN4QyxNQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDO1FBQ2hDLE1BQU07UUFDTixRQUFRLEVBQUUsUUFBUTtLQUNsQixDQUFDLENBQUM7SUFDSCxPQUFPLFNBQVMsQ0FBQztBQUNsQixDQUFDO0FBRUQsU0FBUyxlQUFlLENBQUMsTUFBYyxFQUFFLEtBQWE7SUFDckQsTUFBTSxnQkFBZ0IsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUM5QyxNQUFNO1FBQ04sUUFBUSxFQUFFLFFBQVE7UUFDbEIsS0FBSztRQUNMLE1BQU0sRUFBRSxDQUFDLENBQUMsK0JBQStCO0tBQ3pDLENBQUMsQ0FBQztJQUNILE9BQU8sZ0JBQWdCLENBQUM7QUFDekIsQ0FBQztBQUVELEtBQUssVUFBVSxjQUFjLENBQUMsV0FBbUI7SUFDaEQsT0FBTyxNQUFNLE1BQU0sQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDNUMsQ0FBQztBQUVELE9BQU8sRUFDTixrQkFBa0IsRUFDbEIsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixjQUFjLEVBQ2QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBzcGVha2Vhc3kgZnJvbSAnc3BlYWtlYXN5JztcbmltcG9ydCBRUkNvZGUgZnJvbSAncXJjb2RlJztcblxuaW50ZXJmYWNlIFRPVFBTZWNyZXQge1xuXHRhc2NpaTogc3RyaW5nO1xuXHRoZXg6IHN0cmluZztcblx0YmFzZTMyOiBzdHJpbmc7XG5cdG90cGF1dGhfdXJsOiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlVE9UUFNlY3JldCgpOiBUT1RQU2VjcmV0IHtcblx0Y29uc3QgdG90cFNlY3JldCA9IHNwZWFrZWFzeS5nZW5lcmF0ZVNlY3JldCh7IGxlbmd0aDogMjAgfSk7XG5cdHJldHVybiB7XG5cdFx0YXNjaWk6IHRvdHBTZWNyZXQuYXNjaWkgfHwgJycsXG5cdFx0aGV4OiB0b3RwU2VjcmV0LmhleCB8fCAnJyxcblx0XHRiYXNlMzI6IHRvdHBTZWNyZXQuYmFzZTMyIHx8ICcnLFxuXHRcdG90cGF1dGhfdXJsOiB0b3RwU2VjcmV0Lm90cGF1dGhfdXJsIHx8ICcnXG5cdH07XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlVE9UUFRva2VuKHNlY3JldDogc3RyaW5nKTogc3RyaW5nIHtcblx0Y29uc3QgdG90cFRva2VuID0gc3BlYWtlYXN5LnRvdHAoe1xuXHRcdHNlY3JldCxcblx0XHRlbmNvZGluZzogJ2Jhc2UzMidcblx0fSk7XG5cdHJldHVybiB0b3RwVG9rZW47XG59XG5cbmZ1bmN0aW9uIHZlcmlmeVRPVFBUb2tlbihzZWNyZXQ6IHN0cmluZywgdG9rZW46IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRjb25zdCBpc1RPVFBUb2tlblZhbGlkID0gc3BlYWtlYXN5LnRvdHAudmVyaWZ5KHtcblx0XHRzZWNyZXQsXG5cdFx0ZW5jb2Rpbmc6ICdiYXNlMzInLFxuXHRcdHRva2VuLFxuXHRcdHdpbmRvdzogMSAvLyBnaXZlcyBsZWV3YXkgZm9yIGNsb2NrIGRyaWZ0XG5cdH0pO1xuXHRyZXR1cm4gaXNUT1RQVG9rZW5WYWxpZDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVRUkNvZGUob3RwYXV0aF91cmw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdHJldHVybiBhd2FpdCBRUkNvZGUudG9EYXRhVVJMKG90cGF1dGhfdXJsKTtcbn1cblxuZXhwb3J0IHtcblx0Z2VuZXJhdGVUT1RQU2VjcmV0LFxuXHRnZW5lcmF0ZVRPVFBUb2tlbixcblx0dmVyaWZ5VE9UUFRva2VuLFxuXHRnZW5lcmF0ZVFSQ29kZVxufTtcbiJdfQ==
