export default function createTOTPUtil({ speakeasy, QRCode }) {
	function generateTOTPSecret() {
		const totpSecret = speakeasy.generateSecret({ length: 20 });
		return {
			ascii: totpSecret.ascii || '',
			hex: totpSecret.hex || '',
			base32: totpSecret.base32 || '',
			otpauth_url: totpSecret.otpauth_url || ''
		};
	}
	function generateTOTPToken(secret) {
		const totpToken = speakeasy.totp({
			secret,
			encoding: 'base32'
		});
		return totpToken;
	}
	function verifyTOTPToken(secret, token) {
		const isTOTPTokenValid = speakeasy.totp.verify({
			secret,
			encoding: 'base32',
			token,
			window: 1 // gives leeway for clock drift
		});
		return isTOTPTokenValid;
	}
	async function generateQRCode(otpauth_url) {
		return await QRCode.toDataURL(otpauth_url);
	}
	return {
		generateTOTPSecret,
		generateTOTPToken,
		verifyTOTPToken,
		generateQRCode
	};
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG90cFV0aWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdXRpbHMvYXV0aC90b3RwVXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFjQSxNQUFNLENBQUMsT0FBTyxVQUFVLGNBQWMsQ0FBQyxFQUN0QyxTQUFTLEVBQ1QsTUFBTSxFQUNnQjtJQU10QixTQUFTLGtCQUFrQjtRQUMxQixNQUFNLFVBQVUsR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDNUQsT0FBTztZQUNOLEtBQUssRUFBRSxVQUFVLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDN0IsR0FBRyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUksRUFBRTtZQUN6QixNQUFNLEVBQUUsVUFBVSxDQUFDLE1BQU0sSUFBSSxFQUFFO1lBQy9CLFdBQVcsRUFBRSxVQUFVLENBQUMsV0FBVyxJQUFJLEVBQUU7U0FDekMsQ0FBQztJQUNILENBQUM7SUFFRCxTQUFTLGlCQUFpQixDQUFDLE1BQWM7UUFDeEMsTUFBTSxTQUFTLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQztZQUNoQyxNQUFNO1lBQ04sUUFBUSxFQUFFLFFBQVE7U0FDbEIsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxTQUFTLENBQUM7SUFDbEIsQ0FBQztJQUVELFNBQVMsZUFBZSxDQUFDLE1BQWMsRUFBRSxLQUFhO1FBQ3JELE1BQU0sZ0JBQWdCLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7WUFDOUMsTUFBTTtZQUNOLFFBQVEsRUFBRSxRQUFRO1lBQ2xCLEtBQUs7WUFDTCxNQUFNLEVBQUUsQ0FBQyxDQUFDLCtCQUErQjtTQUN6QyxDQUFDLENBQUM7UUFDSCxPQUFPLGdCQUFnQixDQUFDO0lBQ3pCLENBQUM7SUFFRCxLQUFLLFVBQVUsY0FBYyxDQUFDLFdBQW1CO1FBQ2hELE9BQU8sTUFBTSxNQUFNLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRCxPQUFPO1FBQ04sa0JBQWtCO1FBQ2xCLGlCQUFpQjtRQUNqQixlQUFlO1FBQ2YsY0FBYztLQUNkLENBQUM7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFFSQ29kZSBmcm9tICdxcmNvZGUnO1xuXG5pbnRlcmZhY2UgVE9UUFNlY3JldCB7XG5cdGFzY2lpOiBzdHJpbmc7XG5cdGhleDogc3RyaW5nO1xuXHRiYXNlMzI6IHN0cmluZztcblx0b3RwYXV0aF91cmw6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFRPVFBVdGlsRGVwZW5kZW5jaWVzIHtcblx0c3BlYWtlYXN5OiB0eXBlb2YgaW1wb3J0KCdzcGVha2Vhc3knKTtcblx0UVJDb2RlOiB0eXBlb2YgUVJDb2RlO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVUT1RQVXRpbCh7XG5cdHNwZWFrZWFzeSxcblx0UVJDb2RlXG59OiBUT1RQVXRpbERlcGVuZGVuY2llcyk6IHtcblx0Z2VuZXJhdGVUT1RQU2VjcmV0OiAoKSA9PiBUT1RQU2VjcmV0O1xuXHRnZW5lcmF0ZVRPVFBUb2tlbjogKHNlY3JldDogc3RyaW5nKSA9PiBzdHJpbmc7XG5cdHZlcmlmeVRPVFBUb2tlbjogKHNlY3JldDogc3RyaW5nLCB0b2tlbjogc3RyaW5nKSA9PiBib29sZWFuO1xuXHRnZW5lcmF0ZVFSQ29kZTogKG90cGF1dGhfdXJsOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nPjtcbn0ge1xuXHRmdW5jdGlvbiBnZW5lcmF0ZVRPVFBTZWNyZXQoKTogVE9UUFNlY3JldCB7XG5cdFx0Y29uc3QgdG90cFNlY3JldCA9IHNwZWFrZWFzeS5nZW5lcmF0ZVNlY3JldCh7IGxlbmd0aDogMjAgfSk7XG5cdFx0cmV0dXJuIHtcblx0XHRcdGFzY2lpOiB0b3RwU2VjcmV0LmFzY2lpIHx8ICcnLFxuXHRcdFx0aGV4OiB0b3RwU2VjcmV0LmhleCB8fCAnJyxcblx0XHRcdGJhc2UzMjogdG90cFNlY3JldC5iYXNlMzIgfHwgJycsXG5cdFx0XHRvdHBhdXRoX3VybDogdG90cFNlY3JldC5vdHBhdXRoX3VybCB8fCAnJ1xuXHRcdH07XG5cdH1cblxuXHRmdW5jdGlvbiBnZW5lcmF0ZVRPVFBUb2tlbihzZWNyZXQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgdG90cFRva2VuID0gc3BlYWtlYXN5LnRvdHAoe1xuXHRcdFx0c2VjcmV0LFxuXHRcdFx0ZW5jb2Rpbmc6ICdiYXNlMzInXG5cdFx0fSk7XG5cdFx0cmV0dXJuIHRvdHBUb2tlbjtcblx0fVxuXG5cdGZ1bmN0aW9uIHZlcmlmeVRPVFBUb2tlbihzZWNyZXQ6IHN0cmluZywgdG9rZW46IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGNvbnN0IGlzVE9UUFRva2VuVmFsaWQgPSBzcGVha2Vhc3kudG90cC52ZXJpZnkoe1xuXHRcdFx0c2VjcmV0LFxuXHRcdFx0ZW5jb2Rpbmc6ICdiYXNlMzInLFxuXHRcdFx0dG9rZW4sXG5cdFx0XHR3aW5kb3c6IDEgLy8gZ2l2ZXMgbGVld2F5IGZvciBjbG9jayBkcmlmdFxuXHRcdH0pO1xuXHRcdHJldHVybiBpc1RPVFBUb2tlblZhbGlkO1xuXHR9XG5cblx0YXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVRUkNvZGUob3RwYXV0aF91cmw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0cmV0dXJuIGF3YWl0IFFSQ29kZS50b0RhdGFVUkwob3RwYXV0aF91cmwpO1xuXHR9XG5cblx0cmV0dXJuIHtcblx0XHRnZW5lcmF0ZVRPVFBTZWNyZXQsXG5cdFx0Z2VuZXJhdGVUT1RQVG9rZW4sXG5cdFx0dmVyaWZ5VE9UUFRva2VuLFxuXHRcdGdlbmVyYXRlUVJDb2RlXG5cdH07XG59XG4iXX0=
