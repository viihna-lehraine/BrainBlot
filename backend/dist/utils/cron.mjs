import cron from 'node-cron';
import { fileURLToPath } from 'url';
import { ServiceFactory } from '../index/factory.mjs';
export async function createCronJobs({
	compressing,
	exec,
	fs,
	path,
	processEnv,
	sequelize
}) {
	const logger = await ServiceFactory.getLoggerService();
	const errorLogger = await ServiceFactory.getErrorLoggerService();
	const errorHandler = await ServiceFactory.getErrorHandlerService();
	const __filename = fileURLToPath(import.meta.url);
	const __dirname = path.dirname(__filename);
	try {
		if (
			!processEnv.SERVER_LOG_PATH ||
			!processEnv.SERVER_NPM_LOG_PATH ||
			!processEnv.BACKEND_LOGGER_EXPORT_PATH
		) {
			throw new Error(`Required environment variables are missing`);
		}
		const compressAndExportLogs = async (
			sourceDir,
			exportDir,
			logFileName
		) => {
			const timestamp = new Date().toISOString().replace(/:/g, '-');
			const outputFileName = `${logFileName.replace('.log', '')}-${timestamp}.gz`;
			const outputFilePath = path.join(exportDir, outputFileName);
			const sourceFilePath = path.join(sourceDir, logFileName);
			try {
				await compressing.gzip.compressFile(
					sourceFilePath,
					outputFilePath
				);
				logger.info(`${logFileName} successfully compressed`);
				return outputFilePath;
			} catch (error) {
				errorHandler.handleError({ error });
				throw new Error(
					`Error compressing log files: ${error instanceof Error ? error.message : String(error)}`
				);
			}
		};
		const runCommandAndLog = (command, logFilePath) => {
			return new Promise((resolve, reject) => {
				const logStream = fs.createWriteStream(logFilePath, {
					flags: 'a'
				});
				const process = exec(
					command,
					{ maxBuffer: 1024 * 500 },
					(error, stdout, stderr) => {
						if (error) {
							logStream.write(`ERROR: ${error.message}\n`);
							return reject(error);
						}
						if (stderr) {
							logStream.write(`STDERR: ${stderr}\n`);
						}
						logStream.write(stdout);
						logStream.end();
						resolve();
					}
				);
				if (process.stdout) process.stdout.pipe(logStream);
				if (process.stderr) process.stderr.pipe(logStream);
			});
		};
		const exportLogs = async () => {
			const serverLogDir = path.join(
				__dirname,
				processEnv.SERVER_LOG_PATH
			);
			const npmLogDir = path.join(
				__dirname,
				processEnv.SERVER_NPM_LOG_PATH
			);
			const exportDir = path.join(
				__dirname,
				processEnv.BACKEND_LOGGER_EXPORT_PATH
			);
			if (!fs.existsSync(exportDir)) {
				try {
					fs.mkdirSync(exportDir, { recursive: true });
				} catch (error) {
					errorHandler.handleError({ error });
					throw new Error(
						`Error creating export directory: ${
							error instanceof Error
								? error.message
								: String(error)
						}`
					);
				}
			}
			try {
				// compress and export server logs
				const serverLogFiles = fs
					.readdirSync(serverLogDir)
					.filter(file => file.endsWith('.log'));
				for (const logFile of serverLogFiles) {
					await compressAndExportLogs(
						serverLogDir,
						exportDir,
						logFile
					);
				}
				// compress and export npm logs
				const npmLogFiles = fs
					.readdirSync(npmLogDir)
					.filter(file => file.endsWith('.logs'));
				for (const logFile of npmLogFiles) {
					await compressAndExportLogs(npmLogDir, exportDir, logFile);
				}
				logger.info(
					'Logs have been successfully compressed and exported.'
				);
			} catch (error) {
				errorHandler.handleError({ error });
				throw new Error(
					`Error exporting logs: ${error instanceof Error ? error.message : String(error)}`
				);
			}
		};
		const cleanupLogs = async () => {
			try {
				await errorLogger.cleanUpOldLogs(sequelize, 30);
				logger.info('Scheduled log cleanup completed successfully');
			} catch (error) {
				errorHandler.handleError({ error });
				logger.error('Scheduled log cleanup failed');
			}
		};
		const performNpmTasks = async () => {
			const npmLogDir = path.join(
				__dirname,
				processEnv.SERVER_NPM_LOG_PATH
			);
			const timestamp = new Date().toISOString().replace(/:/g, '-');
			const logFilePath = path.join(
				npmLogDir,
				`npm-audit-update-${timestamp}.log`
			);
			try {
				logger.info('Starting npm audit...');
				await runCommandAndLog('npm audit --verbose', logFilePath);
				logger.info('npm audit completed successfully.');
				logger.info('Starting npm update...');
				await runCommandAndLog('npm update --verbose', logFilePath);
				logger.info('npm update completed successfully.');
			} catch (error) {
				errorHandler.handleError({ error });
			}
		};
		const scheduleLogJobs = () => {
			let schedule = '';
			switch (processEnv.LOGGER) {
				case '0':
					break;
				case '1':
					schedule = '*/2 * * * *';
					exportLogs();
					break;
				case '2':
					schedule = '0 */2 * * *';
					break;
				case '3':
					schedule = '0 */6 * * *';
					break;
				case '4':
					schedule = '0 */12 * * *';
					break;
				case '5':
					schedule = '0 0 * * *';
					break;
				case '6':
					schedule = '0 0 */2 * *';
					break;
				case '7':
					schedule = '0 0 * * 0';
					break;
				default:
					schedule = '0 0 * * *';
					logger.warn(
						'LOGGER variable not set. Defaulting to nightly log export'
					);
			}
			if (schedule) {
				cron.schedule(schedule, () => {
					exportLogs().catch(error =>
						errorHandler.handleError({ error })
					);
				});
			}
			cron.schedule('0 0 * * *', () => {
				cleanupLogs().catch(error =>
					errorHandler.handleError({ error })
				);
			});
			cron.schedule('0 * * * *', () => {
				performNpmTasks().catch(error =>
					errorHandler.handleError({ error })
				);
			});
		};
		scheduleLogJobs();
	} catch (error) {
		errorHandler.handleError({ error });
		throw new Error(
			`Failed to create cron jobs: ${error instanceof Error ? error.message : String(error)}`
		);
	}
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3Jvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9jcm9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sSUFBSSxNQUFNLFdBQVcsQ0FBQztBQUU3QixPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sS0FBSyxDQUFDO0FBQ3BDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQWFsRCxNQUFNLENBQUMsS0FBSyxVQUFVLGNBQWMsQ0FBQyxFQUNwQyxXQUFXLEVBQ1gsSUFBSSxFQUNKLEVBQUUsRUFDRixJQUFJLEVBQ0osVUFBVSxFQUNWLFNBQVMsRUFDTTtJQUNmLE1BQU0sTUFBTSxHQUFHLE1BQU0sY0FBYyxDQUFDLGdCQUFnQixFQUFFLENBQUM7SUFDdkQsTUFBTSxXQUFXLEdBQUcsTUFBTSxjQUFjLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUNqRSxNQUFNLFlBQVksR0FBRyxNQUFNLGNBQWMsQ0FBQyxzQkFBc0IsRUFBRSxDQUFDO0lBQ25FLE1BQU0sVUFBVSxHQUFHLGFBQWEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2xELE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7SUFFM0MsSUFBSSxDQUFDO1FBQ0osSUFDQyxDQUFDLFVBQVUsQ0FBQyxlQUFlO1lBQzNCLENBQUMsVUFBVSxDQUFDLG1CQUFtQjtZQUMvQixDQUFDLFVBQVUsQ0FBQywwQkFBMEIsRUFDckMsQ0FBQztZQUNGLE1BQU0sSUFBSSxLQUFLLENBQUMsNENBQTRDLENBQUMsQ0FBQztRQUMvRCxDQUFDO1FBRUQsTUFBTSxxQkFBcUIsR0FBRyxLQUFLLEVBQ2xDLFNBQWlCLEVBQ2pCLFNBQWlCLEVBQ2pCLFdBQW1CLEVBQ0QsRUFBRTtZQUNwQixNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDLE9B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QUFDRixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhlYywgRXhlY0V4Y2VwdGlvbiB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IGNvbXByZXNzaW5nIGZyb20gJ2NvbXByZXNzaW5nJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgY3JvbiBmcm9tICdub2RlLWNyb24nO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBmaWxlVVJMVG9QYXRoIH0gZnJvbSAndXJsJztcbmltcG9ydCB7IFNlcnZpY2VGYWN0b3J5IH0gZnJvbSAnLi4vaW5kZXgvZmFjdG9yeSc7XG5pbXBvcnQgeyBTZXF1ZWxpemUgfSBmcm9tICdzZXF1ZWxpemUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIENyb25JbnRlcmZhY2Uge1xuXHRjb21wcmVzc2luZzogdHlwZW9mIGNvbXByZXNzaW5nO1xuXHRleGVjOiB0eXBlb2YgZXhlYztcblx0ZnM6IHR5cGVvZiBmcztcblx0cGF0aDogdHlwZW9mIHBhdGg7XG5cdHByb2Nlc3NFbnY6IE5vZGVKUy5Qcm9jZXNzRW52O1xuXHRzZXF1ZWxpemU6IFNlcXVlbGl6ZTtcblx0X19kaXJuYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDcm9uSm9icyh7XG5cdGNvbXByZXNzaW5nLFxuXHRleGVjLFxuXHRmcyxcblx0cGF0aCxcblx0cHJvY2Vzc0Vudixcblx0c2VxdWVsaXplXG59OiBDcm9uSW50ZXJmYWNlKTogUHJvbWlzZTx2b2lkPiB7XG5cdGNvbnN0IGxvZ2dlciA9IGF3YWl0IFNlcnZpY2VGYWN0b3J5LmdldExvZ2dlclNlcnZpY2UoKTtcblx0Y29uc3QgZXJyb3JMb2dnZXIgPSBhd2FpdCBTZXJ2aWNlRmFjdG9yeS5nZXRFcnJvckxvZ2dlclNlcnZpY2UoKTtcblx0Y29uc3QgZXJyb3JIYW5kbGVyID0gYXdhaXQgU2VydmljZUZhY3RvcnkuZ2V0RXJyb3JIYW5kbGVyU2VydmljZSgpO1xuXHRjb25zdCBfX2ZpbGVuYW1lID0gZmlsZVVSTFRvUGF0aChpbXBvcnQubWV0YS51cmwpO1xuXHRjb25zdCBfX2Rpcm5hbWUgPSBwYXRoLmRpcm5hbWUoX19maWxlbmFtZSk7XG5cblx0dHJ5IHtcblx0XHRpZiAoXG5cdFx0XHQhcHJvY2Vzc0Vudi5TRVJWRVJfTE9HX1BBVEggfHxcblx0XHRcdCFwcm9jZXNzRW52LlNFUlZFUl9OUE1fTE9HX1BBVEggfHxcblx0XHRcdCFwcm9jZXNzRW52LkJBQ0tFTkRfTE9HR0VSX0VYUE9SVF9QQVRIXG5cdFx0KSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYFJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgbWlzc2luZ2ApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvbXByZXNzQW5kRXhwb3J0TG9ncyA9IGFzeW5jIChcblx0XHRcdHNvdXJjZURpcjogc3RyaW5nLFxuXHRcdFx0ZXhwb3J0RGlyOiBzdHJpbmcsXG5cdFx0XHRsb2dGaWxlTmFtZTogc3RyaW5nXG5cdFx0KTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcblx0XHRcdGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC86L2csICctJyk7XG5cdFx0XHRjb25zdCBvdXRwdXRGaWxlTmFtZSA9IGAke2xvZ0ZpbGVOYW1lLnJlcGxhY2UoJy5sb2cnLCAnJyl9LSR7dGltZXN0YW1wfS5nemA7XG5cdFx0XHRjb25zdCBvdXRwdXRGaWxlUGF0aCA9IHBhdGguam9pbihleHBvcnREaXIsIG91dHB1dEZpbGVOYW1lKTtcblx0XHRcdGNvbnN0IHNvdXJjZUZpbGVQYXRoID0gcGF0aC5qb2luKHNvdXJjZURpciwgbG9nRmlsZU5hbWUpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRhd2FpdCBjb21wcmVzc2luZy5nemlwLmNvbXByZXNzRmlsZShcblx0XHRcdFx0XHRzb3VyY2VGaWxlUGF0aCxcblx0XHRcdFx0XHRvdXRwdXRGaWxlUGF0aFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRsb2dnZXIuaW5mbyhgJHtsb2dGaWxlTmFtZX0gc3VjY2Vzc2Z1bGx5IGNvbXByZXNzZWRgKTtcblx0XHRcdFx0cmV0dXJuIG91dHB1dEZpbGVQYXRoO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0ZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKHsgZXJyb3IgfSk7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcihcblx0XHRcdFx0XHRgRXJyb3IgY29tcHJlc3NpbmcgbG9nIGZpbGVzOiAke1xuXHRcdFx0XHRcdFx0ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpXG5cdFx0XHRcdFx0fWBcblx0XHRcdFx0KTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Y29uc3QgcnVuQ29tbWFuZEFuZExvZyA9IChcblx0XHRcdGNvbW1hbmQ6IHN0cmluZyxcblx0XHRcdGxvZ0ZpbGVQYXRoOiBzdHJpbmdcblx0XHQpOiBQcm9taXNlPHZvaWQ+ID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGxvZ1N0cmVhbSA9IGZzLmNyZWF0ZVdyaXRlU3RyZWFtKGxvZ0ZpbGVQYXRoLCB7XG5cdFx0XHRcdFx0ZmxhZ3M6ICdhJ1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0Y29uc3QgcHJvY2VzcyA9IGV4ZWMoXG5cdFx0XHRcdFx0Y29tbWFuZCxcblx0XHRcdFx0XHR7IG1heEJ1ZmZlcjogMTAyNCAqIDUwMCB9LFxuXHRcdFx0XHRcdChcblx0XHRcdFx0XHRcdGVycm9yOiBFeGVjRXhjZXB0aW9uIHwgbnVsbCxcblx0XHRcdFx0XHRcdHN0ZG91dDogc3RyaW5nLFxuXHRcdFx0XHRcdFx0c3RkZXJyOiBzdHJpbmdcblx0XHRcdFx0XHQpID0+IHtcblx0XHRcdFx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRcdFx0XHRsb2dTdHJlYW0ud3JpdGUoYEVSUk9SOiAke2Vycm9yLm1lc3NhZ2V9XFxuYCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiByZWplY3QoZXJyb3IpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKHN0ZGVycikge1xuXHRcdFx0XHRcdFx0XHRsb2dTdHJlYW0ud3JpdGUoYFNUREVSUjogJHtzdGRlcnJ9XFxuYCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRsb2dTdHJlYW0ud3JpdGUoc3Rkb3V0KTtcblx0XHRcdFx0XHRcdGxvZ1N0cmVhbS5lbmQoKTtcblx0XHRcdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aWYgKHByb2Nlc3Muc3Rkb3V0KSBwcm9jZXNzLnN0ZG91dC5waXBlKGxvZ1N0cmVhbSk7XG5cdFx0XHRcdGlmIChwcm9jZXNzLnN0ZGVycikgcHJvY2Vzcy5zdGRlcnIucGlwZShsb2dTdHJlYW0pO1xuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdGNvbnN0IGV4cG9ydExvZ3MgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG5cdFx0XHRjb25zdCBzZXJ2ZXJMb2dEaXIgPSBwYXRoLmpvaW4oXG5cdFx0XHRcdF9fZGlybmFtZSxcblx0XHRcdFx0cHJvY2Vzc0Vudi5TRVJWRVJfTE9HX1BBVEghXG5cdFx0XHQpO1xuXHRcdFx0Y29uc3QgbnBtTG9nRGlyID0gcGF0aC5qb2luKFxuXHRcdFx0XHRfX2Rpcm5hbWUsXG5cdFx0XHRcdHByb2Nlc3NFbnYuU0VSVkVSX05QTV9MT0dfUEFUSCFcblx0XHRcdCk7XG5cdFx0XHRjb25zdCBleHBvcnREaXIgPSBwYXRoLmpvaW4oXG5cdFx0XHRcdF9fZGlybmFtZSxcblx0XHRcdFx0cHJvY2Vzc0Vudi5CQUNLRU5EX0xPR0dFUl9FWFBPUlRfUEFUSCFcblx0XHRcdCk7XG5cblx0XHRcdGlmICghZnMuZXhpc3RzU3luYyhleHBvcnREaXIpKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0ZnMubWtkaXJTeW5jKGV4cG9ydERpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0ZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKHsgZXJyb3IgfSk7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFxuXHRcdFx0XHRcdFx0YEVycm9yIGNyZWF0aW5nIGV4cG9ydCBkaXJlY3Rvcnk6ICR7XG5cdFx0XHRcdFx0XHRcdGVycm9yIGluc3RhbmNlb2YgRXJyb3Jcblx0XHRcdFx0XHRcdFx0XHQ/IGVycm9yLm1lc3NhZ2Vcblx0XHRcdFx0XHRcdFx0XHQ6IFN0cmluZyhlcnJvcilcblx0XHRcdFx0XHRcdH1gXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBjb21wcmVzcyBhbmQgZXhwb3J0IHNlcnZlciBsb2dzXG5cdFx0XHRcdGNvbnN0IHNlcnZlckxvZ0ZpbGVzID0gZnNcblx0XHRcdFx0XHQucmVhZGRpclN5bmMoc2VydmVyTG9nRGlyKVxuXHRcdFx0XHRcdC5maWx0ZXIoZmlsZSA9PiBmaWxlLmVuZHNXaXRoKCcubG9nJykpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxvZ0ZpbGUgb2Ygc2VydmVyTG9nRmlsZXMpIHtcblx0XHRcdFx0XHRhd2FpdCBjb21wcmVzc0FuZEV4cG9ydExvZ3MoXG5cdFx0XHRcdFx0XHRzZXJ2ZXJMb2dEaXIsXG5cdFx0XHRcdFx0XHRleHBvcnREaXIsXG5cdFx0XHRcdFx0XHRsb2dGaWxlXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIGNvbXByZXNzIGFuZCBleHBvcnQgbnBtIGxvZ3Ncblx0XHRcdFx0Y29uc3QgbnBtTG9nRmlsZXMgPSBmc1xuXHRcdFx0XHRcdC5yZWFkZGlyU3luYyhucG1Mb2dEaXIpXG5cdFx0XHRcdFx0LmZpbHRlcihmaWxlID0+IGZpbGUuZW5kc1dpdGgoJy5sb2dzJykpO1xuXHRcdFx0XHRmb3IgKGNvbnN0IGxvZ0ZpbGUgb2YgbnBtTG9nRmlsZXMpIHtcblx0XHRcdFx0XHRhd2FpdCBjb21wcmVzc0FuZEV4cG9ydExvZ3MobnBtTG9nRGlyLCBleHBvcnREaXIsIGxvZ0ZpbGUpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0bG9nZ2VyLmluZm8oXG5cdFx0XHRcdFx0J0xvZ3MgaGF2ZSBiZWVuIHN1Y2Nlc3NmdWxseSBjb21wcmVzc2VkIGFuZCBleHBvcnRlZC4nXG5cdFx0XHRcdCk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRlcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IoeyBlcnJvciB9KTtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFxuXHRcdFx0XHRcdGBFcnJvciBleHBvcnRpbmcgbG9nczogJHtcblx0XHRcdFx0XHRcdGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuXHRcdFx0XHRcdH1gXG5cdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdGNvbnN0IGNsZWFudXBMb2dzID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgZXJyb3JMb2dnZXIuY2xlYW5VcE9sZExvZ3Moc2VxdWVsaXplLCAzMCk7XG5cdFx0XHRcdGxvZ2dlci5pbmZvKCdTY2hlZHVsZWQgbG9nIGNsZWFudXAgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0ZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKHsgZXJyb3IgfSk7XG5cdFx0XHRcdGxvZ2dlci5lcnJvcignU2NoZWR1bGVkIGxvZyBjbGVhbnVwIGZhaWxlZCcpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRjb25zdCBwZXJmb3JtTnBtVGFza3MgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG5cdFx0XHRjb25zdCBucG1Mb2dEaXIgPSBwYXRoLmpvaW4oXG5cdFx0XHRcdF9fZGlybmFtZSxcblx0XHRcdFx0cHJvY2Vzc0Vudi5TRVJWRVJfTlBNX0xPR19QQVRIIVxuXHRcdFx0KTtcblx0XHRcdGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC86L2csICctJyk7XG5cdFx0XHRjb25zdCBsb2dGaWxlUGF0aCA9IHBhdGguam9pbihcblx0XHRcdFx0bnBtTG9nRGlyLFxuXHRcdFx0XHRgbnBtLWF1ZGl0LXVwZGF0ZS0ke3RpbWVzdGFtcH0ubG9nYFxuXHRcdFx0KTtcblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bG9nZ2VyLmluZm8oJ1N0YXJ0aW5nIG5wbSBhdWRpdC4uLicpO1xuXHRcdFx0XHRhd2FpdCBydW5Db21tYW5kQW5kTG9nKCducG0gYXVkaXQgLS12ZXJib3NlJywgbG9nRmlsZVBhdGgpO1xuXHRcdFx0XHRsb2dnZXIuaW5mbygnbnBtIGF1ZGl0IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJyk7XG5cblx0XHRcdFx0bG9nZ2VyLmluZm8oJ1N0YXJ0aW5nIG5wbSB1cGRhdGUuLi4nKTtcblx0XHRcdFx0YXdhaXQgcnVuQ29tbWFuZEFuZExvZygnbnBtIHVwZGF0ZSAtLXZlcmJvc2UnLCBsb2dGaWxlUGF0aCk7XG5cdFx0XHRcdGxvZ2dlci5pbmZvKCducG0gdXBkYXRlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJyk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRlcnJvckhhbmRsZXIuaGFuZGxlRXJyb3IoeyBlcnJvciB9KTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Y29uc3Qgc2NoZWR1bGVMb2dKb2JzID0gKCk6IHZvaWQgPT4ge1xuXHRcdFx0bGV0IHNjaGVkdWxlID0gJyc7XG5cblx0XHRcdHN3aXRjaCAocHJvY2Vzc0Vudi5MT0dHRVIpIHtcblx0XHRcdFx0Y2FzZSAnMCc6XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJzEnOlxuXHRcdFx0XHRcdHNjaGVkdWxlID0gJyovMiAqICogKiAqJztcblx0XHRcdFx0XHRleHBvcnRMb2dzKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJzInOlxuXHRcdFx0XHRcdHNjaGVkdWxlID0gJzAgKi8yICogKiAqJztcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnMyc6XG5cdFx0XHRcdFx0c2NoZWR1bGUgPSAnMCAqLzYgKiAqIConO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICc0Jzpcblx0XHRcdFx0XHRzY2hlZHVsZSA9ICcwICovMTIgKiAqIConO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICc1Jzpcblx0XHRcdFx0XHRzY2hlZHVsZSA9ICcwIDAgKiAqIConO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICc2Jzpcblx0XHRcdFx0XHRzY2hlZHVsZSA9ICcwIDAgKi8yICogKic7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJzcnOlxuXHRcdFx0XHRcdHNjaGVkdWxlID0gJzAgMCAqICogMCc7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0c2NoZWR1bGUgPSAnMCAwICogKiAqJztcblx0XHRcdFx0XHRsb2dnZXIud2Fybihcblx0XHRcdFx0XHRcdCdMT0dHRVIgdmFyaWFibGUgbm90IHNldC4gRGVmYXVsdGluZyB0byBuaWdodGx5IGxvZyBleHBvcnQnXG5cdFx0XHRcdFx0KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHNjaGVkdWxlKSB7XG5cdFx0XHRcdGNyb24uc2NoZWR1bGUoc2NoZWR1bGUsICgpID0+IHtcblx0XHRcdFx0XHRleHBvcnRMb2dzKCkuY2F0Y2goZXJyb3IgPT5cblx0XHRcdFx0XHRcdGVycm9ySGFuZGxlci5oYW5kbGVFcnJvcih7IGVycm9yIH0pXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGNyb24uc2NoZWR1bGUoJzAgMCAqICogKicsICgpID0+IHtcblx0XHRcdFx0Y2xlYW51cExvZ3MoKS5jYXRjaChlcnJvciA9PlxuXHRcdFx0XHRcdGVycm9ySGFuZGxlci5oYW5kbGVFcnJvcih7IGVycm9yIH0pXG5cdFx0XHRcdCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Y3Jvbi5zY2hlZHVsZSgnMCAqICogKiAqJywgKCkgPT4ge1xuXHRcdFx0XHRwZXJmb3JtTnBtVGFza3MoKS5jYXRjaChlcnJvciA9PlxuXHRcdFx0XHRcdGVycm9ySGFuZGxlci5oYW5kbGVFcnJvcih7IGVycm9yIH0pXG5cdFx0XHRcdCk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXG5cdFx0c2NoZWR1bGVMb2dKb2JzKCk7XG5cdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0ZXJyb3JIYW5kbGVyLmhhbmRsZUVycm9yKHsgZXJyb3IgfSk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFxuXHRcdFx0YEZhaWxlZCB0byBjcmVhdGUgY3JvbiBqb2JzOiAke1xuXHRcdFx0XHRlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcilcblx0XHRcdH1gXG5cdFx0KTtcblx0fVxufVxuIl19
