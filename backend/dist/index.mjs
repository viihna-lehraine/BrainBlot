import { getSequelizeInstance, initializeDatabase } from './config/db';
import { getFeatureFlags, parseBoolean } from './config/featureFlags';
import loadEnv from './config/loadEnv';
import { setupHttp } from './config/http';
import { createTransporter, getTransporter } from './config/mailer';
import multerConfiguredUpload from './config/multer';
import configurePassport from './config/passport';
import { getRedisClient } from './config/redis';
import errorHandler from './middleware/errorHandler';
import setupSecurityHeaders from './middleware/securityHeaders';
import slowdownMiddleware from './middleware/slowdown';
import { csrfMiddleware } from './middleware/csrf';
import sops from './config/sops';
import {
	addToBlacklist,
	initializeIpBlacklist,
	ipBlacklistMiddleware,
	loadBlacklist,
	removeFromBlacklist
} from './middleware/ipBlacklist';
import { rateLimitMiddleware } from './middleware/rateLimit';
import {
	registrationValidationRules,
	validateEntry
} from './middleware/validator';
import {
	generateBackupCodes,
	getBackupCodesFromDatabase,
	saveBackupCodesToDatabase,
	verifyBackupCode
} from './utils/auth/backupCodeUtil';
import {
	generateEmail2FACode,
	verifyEmail2FACode
} from './utils/auth/email2FAUtil';
//import {
//	generateU2fAuthenticationOptions,
//	generateU2fRegistrationOptions,
//	verifyU2fAuthentication,
//	verifyU2fRegistration
// } from './utils/auth/fido2Util';
import { verifyJwToken } from './utils/auth/jwtUtil';
// import {
// 	generatePasskeyAuthenticationOptions,
// 	generatePasskeyRegistrationOptions,
// 	verifyPasskeyAuthentication,
// 	verifyPasskeyRegistration
// } from './utils/auth/passkeyUtil';
import {
	generateYubicoOtpOptions,
	validateYubicoOTP
} from './utils/auth/yubicoOtpUtil';
import {
	generateTOTPSecret,
	generateTOTPToken,
	verifyTOTPToken,
	generateQRCode
} from './utils/auth/totpUtil';
import generate2FactorEmailTemplate from './utils/emailTemplates/2FactorEmailTemplate';
import generate2FAEnabledEmailTemplate from './utils/emailTemplates/2FAEnabledEmailTemplate';
import generateAccountDeletedConfirmationEmailTemplate from './utils/emailTemplates/accountDeletedConfirmationEmailTemplate';
import generateAccountDeletionStartedEmailTemplate from './utils/emailTemplates/accountDeletionStartedEmailTemplate';
import generateConfirmationEmailTemplate from './utils/emailTemplates/confirmationEmailTemplate';
import loadTestRoutes from './utils/test/loadTestRoutes';
import { startMemoryMonitor } from './utils/memoryMonitor';
export {
	addToBlacklist,
	configurePassport,
	createTransporter,
	csrfMiddleware,
	decryptDataFiles,
	errorHandler,
	generate2FactorEmailTemplate,
	generate2FAEnabledEmailTemplate,
	generateAccountDeletedConfirmationEmailTemplate,
	generateAccountDeletionStartedEmailTemplate,
	generateBackupCodes,
	generateConfirmationEmailTemplate,
	generateEmail2FACode,
	// generatePasskeyAuthenticationOptions,
	// generatePasskeyRegistrationOptions,
	generateQRCode,
	getRedisClient,
	// generateU2fAuthenticationOptions,
	// generateU2fRegistrationOptions,
	generateTOTPSecret,
	generateTOTPToken,
	generateYubicoOtpOptions,
	getBackupCodesFromDatabase,
	getFeatureFlags,
	getSequelizeInstance,
	getSSLKeys,
	getTransporter,
	ipBlacklistMiddleware,
	initializeDatabase,
	initializeIpBlacklist,
	loadBlacklist,
	loadEnv,
	loadTestRoutes,
	multerConfiguredUpload,
	parseBoolean,
	rateLimitMiddleware,
	registrationValidationRules,
	removeFromBlacklist,
	saveBackupCodesToDatabase,
	setupHttp,
	setupSecurityHeaders,
	slowdownMiddleware,
	startMemoryMonitor,
	validateEntry,
	validateYubicoOTP,
	verifyBackupCode,
	verifyEmail2FACode,
	verifyJwToken,
	// verifyPasskeyAuthentication,
	// verifyPasskeyRegistration,
	verifyTOTPToken
	// verifyU2fAuthentication,
	// verifyU2fRegistration
};
const { decryptDataFiles, getSSLKeys } = sops;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLG9CQUFvQixFQUFFLGtCQUFrQixFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3ZFLE9BQU8sRUFBRSxlQUFlLEVBQUUsWUFBWSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDdEUsT0FBTyxPQUFPLE1BQU0sa0JBQWtCLENBQUM7QUFDdkMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMxQyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsY0FBYyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDcEUsT0FBTyxzQkFBc0IsTUFBTSxpQkFBaUIsQ0FBQztBQUNyRCxPQUFPLGlCQUFpQixNQUFNLG1CQUFtQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNoRCxPQUFPLFlBQVksTUFBTSwyQkFBMkIsQ0FBQztBQUNyRCxPQUFPLG9CQUFvQixNQUFNLDhCQUE4QixDQUFDO0FBQ2hFLE9BQU8sa0JBQWtCLE1BQU0sdUJBQXVCLENBQUM7QUFDdkQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ25ELE9BQU8sSUFBSSxNQUFNLGVBQWUsQ0FBQztBQUNqQyxPQUFPLEVBQ04sY0FBYyxFQUNkLHFCQUFxQixFQUNyQixxQkFBcUIsRUFDckIsYUFBYSxFQUNiLG1CQUFtQixFQUNuQixNQUFNLDBCQUEwQixDQUFDO0FBQ2xDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzdELE9BQU8sRUFDTiwyQkFBMkIsRUFDM0IsYUFBYSxFQUNiLE1BQU0sd0JBQXdCLENBQUM7QUFDaEMsT0FBTyxFQUNOLG1CQUFtQixFQUNuQiwwQkFBMEIsRUFDMUIseUJBQXlCLEVBQ3pCLGdCQUFnQixFQUNoQixNQUFNLDZCQUE2QixDQUFDO0FBQ3JDLE9BQU8sRUFDTixvQkFBb0IsRUFDcEIsa0JBQWtCLEVBQ2xCLE1BQU0sMkJBQTJCLENBQUM7QUFDbkMsVUFBVTtBQUNWLG9DQUFvQztBQUNwQyxrQ0FBa0M7QUFDbEMsMkJBQTJCO0FBQzNCLHdCQUF3QjtBQUN4QixtQ0FBbUM7QUFDbkMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3JELFdBQVc7QUFDWCx5Q0FBeUM7QUFDekMsdUNBQXVDO0FBQ3ZDLGdDQUFnQztBQUNoQyw2QkFBNkI7QUFDN0IscUNBQXFDO0FBQ3JDLE9BQU8sRUFDTix3QkFBd0IsRUFDeEIsaUJBQWlCLEVBQ2pCLE1BQU0sNEJBQTRCLENBQUM7QUFDcEMsT0FBTyxFQUNOLGtCQUFrQixFQUNsQixpQkFBaUIsRUFDakIsZUFBZSxFQUNmLGNBQWMsRUFDZCxNQUFNLHVCQUF1QixDQUFDO0FBQy9CLE9BQU8sNEJBQTRCLE1BQU0sNkNBQTZDLENBQUM7QUFDdkYsT0FBTywrQkFBK0IsTUFBTSxnREFBZ0QsQ0FBQztBQUM3RixPQUFPLCtDQUErQyxNQUFNLGdFQUFnRSxDQUFDO0FBQzdILE9BQU8sMkNBQTJDLE1BQU0sNERBQTRELENBQUM7QUFDckgsT0FBTyxpQ0FBaUMsTUFBTSxrREFBa0QsQ0FBQztBQUNqRyxPQUFPLGNBQWMsTUFBTSw2QkFBNkIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUUzRCxPQUFPLEVBQ04sY0FBYyxFQUNkLGlCQUFpQixFQUNqQixpQkFBaUIsRUFDakIsY0FBYyxFQUNkLGdCQUFnQixFQUNoQixZQUFZLEVBQ1osNEJBQTRCLEVBQzVCLCtCQUErQixFQUMvQiwrQ0FBK0MsRUFDL0MsMkNBQTJDLEVBQzNDLG1CQUFtQixFQUNuQixpQ0FBaUMsRUFDakMsb0JBQW9CO0FBQ3BCLHdDQUF3QztBQUN4QyxzQ0FBc0M7QUFDdEMsY0FBYyxFQUNkLGNBQWM7QUFDZCxvQ0FBb0M7QUFDcEMsa0NBQWtDO0FBQ2xDLGtCQUFrQixFQUNsQixpQkFBaUIsRUFDakIsd0JBQXdCLEVBQ3hCLDBCQUEwQixFQUMxQixlQUFlLEVBQ2Ysb0JBQW9CLEVBQ3BCLFVBQVUsRUFDVixjQUFjLEVBQ2QscUJBQXFCLEVBQ3JCLGtCQUFrQixFQUNsQixxQkFBcUIsRUFDckIsYUFBYSxFQUNiLE9BQU8sRUFDUCxjQUFjLEVBQ2Qsc0JBQXNCLEVBQ3RCLFlBQVksRUFDWixtQkFBbUIsRUFDbkIsMkJBQTJCLEVBQzNCLG1CQUFtQixFQUNuQix5QkFBeUIsRUFDekIsU0FBUyxFQUNULG9CQUFvQixFQUNwQixrQkFBa0IsRUFDbEIsa0JBQWtCLEVBQ2xCLGFBQWEsRUFDYixpQkFBaUIsRUFDakIsZ0JBQWdCLEVBQ2hCLGtCQUFrQixFQUNsQixhQUFhO0FBQ2IsK0JBQStCO0FBQy9CLDZCQUE2QjtBQUM3QixlQUFlO0FBQ2YsMkJBQTJCO0FBQzNCLHdCQUF3QjtFQUN4QixDQUFDO0FBRUYsTUFBTSxFQUFFLGdCQUFnQixFQUFFLFVBQVUsRUFBRSxHQUFHLElBQUksQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFNlcXVlbGl6ZUluc3RhbmNlLCBpbml0aWFsaXplRGF0YWJhc2UgfSBmcm9tICcuL2NvbmZpZy9kYic7XG5pbXBvcnQgeyBnZXRGZWF0dXJlRmxhZ3MsIHBhcnNlQm9vbGVhbiB9IGZyb20gJy4vY29uZmlnL2ZlYXR1cmVGbGFncyc7XG5pbXBvcnQgbG9hZEVudiBmcm9tICcuL2NvbmZpZy9sb2FkRW52JztcbmltcG9ydCB7IHNldHVwSHR0cCB9IGZyb20gJy4vY29uZmlnL2h0dHAnO1xuaW1wb3J0IHsgY3JlYXRlVHJhbnNwb3J0ZXIsIGdldFRyYW5zcG9ydGVyIH0gZnJvbSAnLi9jb25maWcvbWFpbGVyJztcbmltcG9ydCBtdWx0ZXJDb25maWd1cmVkVXBsb2FkIGZyb20gJy4vY29uZmlnL211bHRlcic7XG5pbXBvcnQgY29uZmlndXJlUGFzc3BvcnQgZnJvbSAnLi9jb25maWcvcGFzc3BvcnQnO1xuaW1wb3J0IHsgZ2V0UmVkaXNDbGllbnQgfSBmcm9tICcuL2NvbmZpZy9yZWRpcyc7XG5pbXBvcnQgZXJyb3JIYW5kbGVyIGZyb20gJy4vbWlkZGxld2FyZS9lcnJvckhhbmRsZXInO1xuaW1wb3J0IHNldHVwU2VjdXJpdHlIZWFkZXJzIGZyb20gJy4vbWlkZGxld2FyZS9zZWN1cml0eUhlYWRlcnMnO1xuaW1wb3J0IHNsb3dkb3duTWlkZGxld2FyZSBmcm9tICcuL21pZGRsZXdhcmUvc2xvd2Rvd24nO1xuaW1wb3J0IHsgY3NyZk1pZGRsZXdhcmUgfSBmcm9tICcuL21pZGRsZXdhcmUvY3NyZic7XG5pbXBvcnQgc29wcyBmcm9tICcuL2NvbmZpZy9zb3BzJztcbmltcG9ydCB7XG5cdGFkZFRvQmxhY2tsaXN0LFxuXHRpbml0aWFsaXplSXBCbGFja2xpc3QsXG5cdGlwQmxhY2tsaXN0TWlkZGxld2FyZSxcblx0bG9hZEJsYWNrbGlzdCxcblx0cmVtb3ZlRnJvbUJsYWNrbGlzdFxufSBmcm9tICcuL21pZGRsZXdhcmUvaXBCbGFja2xpc3QnO1xuaW1wb3J0IHsgcmF0ZUxpbWl0TWlkZGxld2FyZSB9IGZyb20gJy4vbWlkZGxld2FyZS9yYXRlTGltaXQnO1xuaW1wb3J0IHtcblx0cmVnaXN0cmF0aW9uVmFsaWRhdGlvblJ1bGVzLFxuXHR2YWxpZGF0ZUVudHJ5XG59IGZyb20gJy4vbWlkZGxld2FyZS92YWxpZGF0b3InO1xuaW1wb3J0IHtcblx0Z2VuZXJhdGVCYWNrdXBDb2Rlcyxcblx0Z2V0QmFja3VwQ29kZXNGcm9tRGF0YWJhc2UsXG5cdHNhdmVCYWNrdXBDb2Rlc1RvRGF0YWJhc2UsXG5cdHZlcmlmeUJhY2t1cENvZGVcbn0gZnJvbSAnLi91dGlscy9hdXRoL2JhY2t1cENvZGVVdGlsJztcbmltcG9ydCB7XG5cdGdlbmVyYXRlRW1haWwyRkFDb2RlLFxuXHR2ZXJpZnlFbWFpbDJGQUNvZGVcbn0gZnJvbSAnLi91dGlscy9hdXRoL2VtYWlsMkZBVXRpbCc7XG4vL2ltcG9ydCB7XG4vL1x0Z2VuZXJhdGVVMmZBdXRoZW50aWNhdGlvbk9wdGlvbnMsXG4vL1x0Z2VuZXJhdGVVMmZSZWdpc3RyYXRpb25PcHRpb25zLFxuLy9cdHZlcmlmeVUyZkF1dGhlbnRpY2F0aW9uLFxuLy9cdHZlcmlmeVUyZlJlZ2lzdHJhdGlvblxuLy8gfSBmcm9tICcuL3V0aWxzL2F1dGgvZmlkbzJVdGlsJztcbmltcG9ydCB7IHZlcmlmeUp3VG9rZW4gfSBmcm9tICcuL3V0aWxzL2F1dGgvand0VXRpbCc7XG4vLyBpbXBvcnQge1xuLy8gXHRnZW5lcmF0ZVBhc3NrZXlBdXRoZW50aWNhdGlvbk9wdGlvbnMsXG4vLyBcdGdlbmVyYXRlUGFzc2tleVJlZ2lzdHJhdGlvbk9wdGlvbnMsXG4vLyBcdHZlcmlmeVBhc3NrZXlBdXRoZW50aWNhdGlvbixcbi8vIFx0dmVyaWZ5UGFzc2tleVJlZ2lzdHJhdGlvblxuLy8gfSBmcm9tICcuL3V0aWxzL2F1dGgvcGFzc2tleVV0aWwnO1xuaW1wb3J0IHtcblx0Z2VuZXJhdGVZdWJpY29PdHBPcHRpb25zLFxuXHR2YWxpZGF0ZVl1Ymljb09UUFxufSBmcm9tICcuL3V0aWxzL2F1dGgveXViaWNvT3RwVXRpbCc7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZVRPVFBTZWNyZXQsXG5cdGdlbmVyYXRlVE9UUFRva2VuLFxuXHR2ZXJpZnlUT1RQVG9rZW4sXG5cdGdlbmVyYXRlUVJDb2RlXG59IGZyb20gJy4vdXRpbHMvYXV0aC90b3RwVXRpbCc7XG5pbXBvcnQgZ2VuZXJhdGUyRmFjdG9yRW1haWxUZW1wbGF0ZSBmcm9tICcuL3V0aWxzL2VtYWlsVGVtcGxhdGVzLzJGYWN0b3JFbWFpbFRlbXBsYXRlJztcbmltcG9ydCBnZW5lcmF0ZTJGQUVuYWJsZWRFbWFpbFRlbXBsYXRlIGZyb20gJy4vdXRpbHMvZW1haWxUZW1wbGF0ZXMvMkZBRW5hYmxlZEVtYWlsVGVtcGxhdGUnO1xuaW1wb3J0IGdlbmVyYXRlQWNjb3VudERlbGV0ZWRDb25maXJtYXRpb25FbWFpbFRlbXBsYXRlIGZyb20gJy4vdXRpbHMvZW1haWxUZW1wbGF0ZXMvYWNjb3VudERlbGV0ZWRDb25maXJtYXRpb25FbWFpbFRlbXBsYXRlJztcbmltcG9ydCBnZW5lcmF0ZUFjY291bnREZWxldGlvblN0YXJ0ZWRFbWFpbFRlbXBsYXRlIGZyb20gJy4vdXRpbHMvZW1haWxUZW1wbGF0ZXMvYWNjb3VudERlbGV0aW9uU3RhcnRlZEVtYWlsVGVtcGxhdGUnO1xuaW1wb3J0IGdlbmVyYXRlQ29uZmlybWF0aW9uRW1haWxUZW1wbGF0ZSBmcm9tICcuL3V0aWxzL2VtYWlsVGVtcGxhdGVzL2NvbmZpcm1hdGlvbkVtYWlsVGVtcGxhdGUnO1xuaW1wb3J0IGxvYWRUZXN0Um91dGVzIGZyb20gJy4vdXRpbHMvdGVzdC9sb2FkVGVzdFJvdXRlcyc7XG5pbXBvcnQgeyBzdGFydE1lbW9yeU1vbml0b3IgfSBmcm9tICcuL3V0aWxzL21lbW9yeU1vbml0b3InO1xuXG5leHBvcnQge1xuXHRhZGRUb0JsYWNrbGlzdCxcblx0Y29uZmlndXJlUGFzc3BvcnQsXG5cdGNyZWF0ZVRyYW5zcG9ydGVyLFxuXHRjc3JmTWlkZGxld2FyZSxcblx0ZGVjcnlwdERhdGFGaWxlcyxcblx0ZXJyb3JIYW5kbGVyLFxuXHRnZW5lcmF0ZTJGYWN0b3JFbWFpbFRlbXBsYXRlLFxuXHRnZW5lcmF0ZTJGQUVuYWJsZWRFbWFpbFRlbXBsYXRlLFxuXHRnZW5lcmF0ZUFjY291bnREZWxldGVkQ29uZmlybWF0aW9uRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGVBY2NvdW50RGVsZXRpb25TdGFydGVkRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGVCYWNrdXBDb2Rlcyxcblx0Z2VuZXJhdGVDb25maXJtYXRpb25FbWFpbFRlbXBsYXRlLFxuXHRnZW5lcmF0ZUVtYWlsMkZBQ29kZSxcblx0Ly8gZ2VuZXJhdGVQYXNza2V5QXV0aGVudGljYXRpb25PcHRpb25zLFxuXHQvLyBnZW5lcmF0ZVBhc3NrZXlSZWdpc3RyYXRpb25PcHRpb25zLFxuXHRnZW5lcmF0ZVFSQ29kZSxcblx0Z2V0UmVkaXNDbGllbnQsXG5cdC8vIGdlbmVyYXRlVTJmQXV0aGVudGljYXRpb25PcHRpb25zLFxuXHQvLyBnZW5lcmF0ZVUyZlJlZ2lzdHJhdGlvbk9wdGlvbnMsXG5cdGdlbmVyYXRlVE9UUFNlY3JldCxcblx0Z2VuZXJhdGVUT1RQVG9rZW4sXG5cdGdlbmVyYXRlWXViaWNvT3RwT3B0aW9ucyxcblx0Z2V0QmFja3VwQ29kZXNGcm9tRGF0YWJhc2UsXG5cdGdldEZlYXR1cmVGbGFncyxcblx0Z2V0U2VxdWVsaXplSW5zdGFuY2UsXG5cdGdldFNTTEtleXMsXG5cdGdldFRyYW5zcG9ydGVyLFxuXHRpcEJsYWNrbGlzdE1pZGRsZXdhcmUsXG5cdGluaXRpYWxpemVEYXRhYmFzZSxcblx0aW5pdGlhbGl6ZUlwQmxhY2tsaXN0LFxuXHRsb2FkQmxhY2tsaXN0LFxuXHRsb2FkRW52LFxuXHRsb2FkVGVzdFJvdXRlcyxcblx0bXVsdGVyQ29uZmlndXJlZFVwbG9hZCxcblx0cGFyc2VCb29sZWFuLFxuXHRyYXRlTGltaXRNaWRkbGV3YXJlLFxuXHRyZWdpc3RyYXRpb25WYWxpZGF0aW9uUnVsZXMsXG5cdHJlbW92ZUZyb21CbGFja2xpc3QsXG5cdHNhdmVCYWNrdXBDb2Rlc1RvRGF0YWJhc2UsXG5cdHNldHVwSHR0cCxcblx0c2V0dXBTZWN1cml0eUhlYWRlcnMsXG5cdHNsb3dkb3duTWlkZGxld2FyZSxcblx0c3RhcnRNZW1vcnlNb25pdG9yLFxuXHR2YWxpZGF0ZUVudHJ5LFxuXHR2YWxpZGF0ZVl1Ymljb09UUCxcblx0dmVyaWZ5QmFja3VwQ29kZSxcblx0dmVyaWZ5RW1haWwyRkFDb2RlLFxuXHR2ZXJpZnlKd1Rva2VuLFxuXHQvLyB2ZXJpZnlQYXNza2V5QXV0aGVudGljYXRpb24sXG5cdC8vIHZlcmlmeVBhc3NrZXlSZWdpc3RyYXRpb24sXG5cdHZlcmlmeVRPVFBUb2tlblxuXHQvLyB2ZXJpZnlVMmZBdXRoZW50aWNhdGlvbixcblx0Ly8gdmVyaWZ5VTJmUmVnaXN0cmF0aW9uXG59O1xuXG5jb25zdCB7IGRlY3J5cHREYXRhRmlsZXMsIGdldFNTTEtleXMgfSA9IHNvcHM7XG4iXX0=
