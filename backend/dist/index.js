import { initializeDatabase } from './config/db.js';
import featureFlags from './config/featureFlags.js';
import loadEnv, { __dirname } from './config/loadEnv.js';
import { setupHttp } from './config/http.js';
import { createTransporter, getTransporter } from './config/mailer.js';
import multerConfiguredUpload from './config/multer.js';
import configurePassport from './config/passport.js';
// import redisClient from './config/redis.js';
import setupSecurityHeaders from './middleware/securityHeaders.js';
import slowdownMiddleware from './middleware/slowdown.js';
import { csrfMiddleware } from './middleware/csrf.js';
import sops from './config/sops.js';
import {
	addToBlacklist,
	initializeIpBlacklist,
	ipBlacklistMiddleware,
	loadBlacklist,
	removeFromBlacklist
} from './middleware/ipBlacklist.js';
import { rateLimitMiddleware } from './middleware/rateLimit.js';
import {
	registrationValidationRules,
	validateEntry
} from './middleware/validator.js';
import {
	generateBackupCodes,
	getBackupCodesFromDatabase,
	saveBackupCodesToDatabase,
	verifyBackupCode
} from './utils/auth/backupCodeUtil.js';
import {
	generateEmail2FACode,
	verifyEmail2FACode
} from './utils/auth/email2FAUtil.js';
//import {
//	generateU2fAuthenticationOptions,
//	generateU2fRegistrationOptions,
//	verifyU2fAuthentication,
//	verifyU2fRegistration
// } from './utils/auth/fido2Util';
import { verifyJwToken } from './utils/auth/jwtUtil.js';
// import {
// 	generatePasskeyAuthenticationOptions,
// 	generatePasskeyRegistrationOptions,
// 	verifyPasskeyAuthentication,
// 	verifyPasskeyRegistration
// } from './utils/auth/passkeyUtil';
import {
	generateYubicoOtpOptions,
	validateYubicoOTP
} from './utils/auth/yubicoOtpUtil.js';
import {
	generateTOTPSecret,
	generateTOTPToken,
	verifyTOTPToken,
	generateQRCode
} from './utils/auth/totpUtil.js';
import generate2FactorEmailTemplate from './utils/emailTemplates/2FactorEmailTemplate.js';
import generate2FAEnabledEmailTemplate from './utils/emailTemplates/2FAEnabledEmailTemplate.js';
import generateAccountDeletedConfirmationEmailTemplate from './utils/emailTemplates/accountDeletedConfirmationEmailTemplate.js';
import generateAccountDeletionStartedEmailTemplate from './utils/emailTemplates/accountDeletionStartedEmailTemplate.js';
import generateConfirmationEmailTemplate from './utils/emailTemplates/confirmationEmailTemplate.js';
import loadTestRoutes from './utils/test/loadTestRoutes.js';
import { parseBoolean } from './utils/parseBoolean.js';
export {
	addToBlacklist,
	configurePassport,
	createTransporter,
	csrfMiddleware,
	decryptDataFiles,
	featureFlags,
	generate2FactorEmailTemplate,
	generate2FAEnabledEmailTemplate,
	generateAccountDeletedConfirmationEmailTemplate,
	generateAccountDeletionStartedEmailTemplate,
	generateBackupCodes,
	generateConfirmationEmailTemplate,
	generateEmail2FACode,
	// generatePasskeyAuthenticationOptions,
	// generatePasskeyRegistrationOptions,
	generateQRCode,
	// generateU2fAuthenticationOptions,
	// generateU2fRegistrationOptions,
	generateTOTPSecret,
	generateTOTPToken,
	generateYubicoOtpOptions,
	getBackupCodesFromDatabase,
	getSSLKeys,
	getTransporter,
	ipBlacklistMiddleware,
	initializeDatabase,
	initializeIpBlacklist,
	loadBlacklist,
	loadEnv,
	loadTestRoutes,
	multerConfiguredUpload,
	parseBoolean,
	rateLimitMiddleware,
	//	redisClient,
	registrationValidationRules,
	removeFromBlacklist,
	saveBackupCodesToDatabase,
	setupHttp,
	setupSecurityHeaders,
	slowdownMiddleware,
	validateEntry,
	validateYubicoOTP,
	verifyBackupCode,
	verifyEmail2FACode,
	verifyJwToken,
	// verifyPasskeyAuthentication,
	// verifyPasskeyRegistration,
	verifyTOTPToken,
	// verifyU2fAuthentication,
	// verifyU2fRegistration,
	__dirname
};
const { decryptDataFiles, getSSLKeys } = sops;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ2pELE9BQU8sWUFBWSxNQUFNLHVCQUF1QixDQUFDO0FBQ2pELE9BQU8sT0FBTyxFQUFFLEVBQUUsU0FBUyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDdEQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMxQyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsY0FBYyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDcEUsT0FBTyxzQkFBc0IsTUFBTSxpQkFBaUIsQ0FBQztBQUNyRCxPQUFPLGlCQUFpQixNQUFNLG1CQUFtQixDQUFDO0FBQ2xELDRDQUE0QztBQUM1QyxPQUFPLG9CQUFvQixNQUFNLDhCQUE4QixDQUFDO0FBQ2hFLE9BQU8sa0JBQWtCLE1BQU0sdUJBQXVCLENBQUM7QUFDdkQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ25ELE9BQU8sSUFBSSxNQUFNLGVBQWUsQ0FBQztBQUNqQyxPQUFPLEVBQ04sY0FBYyxFQUNkLHFCQUFxQixFQUNyQixxQkFBcUIsRUFDckIsYUFBYSxFQUNiLG1CQUFtQixFQUNuQixNQUFNLDBCQUEwQixDQUFDO0FBQ2xDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQzdELE9BQU8sRUFDTiwyQkFBMkIsRUFDM0IsYUFBYSxFQUNiLE1BQU0sd0JBQXdCLENBQUM7QUFDaEMsT0FBTyxFQUNOLG1CQUFtQixFQUNuQiwwQkFBMEIsRUFDMUIseUJBQXlCLEVBQ3pCLGdCQUFnQixFQUNoQixNQUFNLDZCQUE2QixDQUFDO0FBQ3JDLE9BQU8sRUFDTixvQkFBb0IsRUFDcEIsa0JBQWtCLEVBQ2xCLE1BQU0sMkJBQTJCLENBQUM7QUFDbkMsVUFBVTtBQUNWLG9DQUFvQztBQUNwQyxrQ0FBa0M7QUFDbEMsMkJBQTJCO0FBQzNCLHdCQUF3QjtBQUN4QixtQ0FBbUM7QUFDbkMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3JELFdBQVc7QUFDWCx5Q0FBeUM7QUFDekMsdUNBQXVDO0FBQ3ZDLGdDQUFnQztBQUNoQyw2QkFBNkI7QUFDN0IscUNBQXFDO0FBQ3JDLE9BQU8sRUFDTix3QkFBd0IsRUFDeEIsaUJBQWlCLEVBQ2pCLE1BQU0sNEJBQTRCLENBQUM7QUFDcEMsT0FBTyxFQUNOLGtCQUFrQixFQUNsQixpQkFBaUIsRUFDakIsZUFBZSxFQUNmLGNBQWMsRUFDZCxNQUFNLHVCQUF1QixDQUFDO0FBQy9CLE9BQU8sNEJBQTRCLE1BQU0sNkNBQTZDLENBQUM7QUFDdkYsT0FBTywrQkFBK0IsTUFBTSxnREFBZ0QsQ0FBQztBQUM3RixPQUFPLCtDQUErQyxNQUFNLGdFQUFnRSxDQUFDO0FBQzdILE9BQU8sMkNBQTJDLE1BQU0sNERBQTRELENBQUM7QUFDckgsT0FBTyxpQ0FBaUMsTUFBTSxrREFBa0QsQ0FBQztBQUNqRyxPQUFPLGNBQWMsTUFBTSw2QkFBNkIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFcEQsT0FBTyxFQUNOLGNBQWMsRUFDZCxpQkFBaUIsRUFDakIsaUJBQWlCLEVBQ2pCLGNBQWMsRUFDZCxnQkFBZ0IsRUFDaEIsWUFBWSxFQUNaLDRCQUE0QixFQUM1QiwrQkFBK0IsRUFDL0IsK0NBQStDLEVBQy9DLDJDQUEyQyxFQUMzQyxtQkFBbUIsRUFDbkIsaUNBQWlDLEVBQ2pDLG9CQUFvQjtBQUNwQix3Q0FBd0M7QUFDeEMsc0NBQXNDO0FBQ3RDLGNBQWM7QUFDZCxvQ0FBb0M7QUFDcEMsa0NBQWtDO0FBQ2xDLGtCQUFrQixFQUNsQixpQkFBaUIsRUFDakIsd0JBQXdCLEVBQ3hCLDBCQUEwQixFQUMxQixVQUFVLEVBQ1YsY0FBYyxFQUNkLHFCQUFxQixFQUNyQixrQkFBa0IsRUFDbEIscUJBQXFCLEVBQ3JCLGFBQWEsRUFDYixPQUFPLEVBQ1AsY0FBYyxFQUNkLHNCQUFzQixFQUN0QixZQUFZLEVBQ1osbUJBQW1CO0FBQ25CLGVBQWU7QUFDZiwyQkFBMkIsRUFDM0IsbUJBQW1CLEVBQ25CLHlCQUF5QixFQUN6QixTQUFTLEVBQ1Qsb0JBQW9CLEVBQ3BCLGtCQUFrQixFQUNsQixhQUFhLEVBQ2IsaUJBQWlCLEVBQ2pCLGdCQUFnQixFQUNoQixrQkFBa0IsRUFDbEIsYUFBYTtBQUNiLCtCQUErQjtBQUMvQiw2QkFBNkI7QUFDN0IsZUFBZTtBQUNmLDJCQUEyQjtBQUMzQix5QkFBeUI7QUFDekIsU0FBUyxFQUNULENBQUM7QUFFRixNQUFNLEVBQUUsZ0JBQWdCLEVBQUUsVUFBVSxFQUFFLEdBQUcsSUFBSSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5pdGlhbGl6ZURhdGFiYXNlIH0gZnJvbSAnLi9jb25maWcvZGInO1xuaW1wb3J0IGZlYXR1cmVGbGFncyBmcm9tICcuL2NvbmZpZy9mZWF0dXJlRmxhZ3MnO1xuaW1wb3J0IGxvYWRFbnYsIHsgX19kaXJuYW1lIH0gZnJvbSAnLi9jb25maWcvbG9hZEVudic7XG5pbXBvcnQgeyBzZXR1cEh0dHAgfSBmcm9tICcuL2NvbmZpZy9odHRwJztcbmltcG9ydCB7IGNyZWF0ZVRyYW5zcG9ydGVyLCBnZXRUcmFuc3BvcnRlciB9IGZyb20gJy4vY29uZmlnL21haWxlcic7XG5pbXBvcnQgbXVsdGVyQ29uZmlndXJlZFVwbG9hZCBmcm9tICcuL2NvbmZpZy9tdWx0ZXInO1xuaW1wb3J0IGNvbmZpZ3VyZVBhc3Nwb3J0IGZyb20gJy4vY29uZmlnL3Bhc3Nwb3J0Jztcbi8vIGltcG9ydCByZWRpc0NsaWVudCBmcm9tICcuL2NvbmZpZy9yZWRpcyc7XG5pbXBvcnQgc2V0dXBTZWN1cml0eUhlYWRlcnMgZnJvbSAnLi9taWRkbGV3YXJlL3NlY3VyaXR5SGVhZGVycyc7XG5pbXBvcnQgc2xvd2Rvd25NaWRkbGV3YXJlIGZyb20gJy4vbWlkZGxld2FyZS9zbG93ZG93bic7XG5pbXBvcnQgeyBjc3JmTWlkZGxld2FyZSB9IGZyb20gJy4vbWlkZGxld2FyZS9jc3JmJztcbmltcG9ydCBzb3BzIGZyb20gJy4vY29uZmlnL3NvcHMnO1xuaW1wb3J0IHtcblx0YWRkVG9CbGFja2xpc3QsXG5cdGluaXRpYWxpemVJcEJsYWNrbGlzdCxcblx0aXBCbGFja2xpc3RNaWRkbGV3YXJlLFxuXHRsb2FkQmxhY2tsaXN0LFxuXHRyZW1vdmVGcm9tQmxhY2tsaXN0XG59IGZyb20gJy4vbWlkZGxld2FyZS9pcEJsYWNrbGlzdCc7XG5pbXBvcnQgeyByYXRlTGltaXRNaWRkbGV3YXJlIH0gZnJvbSAnLi9taWRkbGV3YXJlL3JhdGVMaW1pdCc7XG5pbXBvcnQge1xuXHRyZWdpc3RyYXRpb25WYWxpZGF0aW9uUnVsZXMsXG5cdHZhbGlkYXRlRW50cnlcbn0gZnJvbSAnLi9taWRkbGV3YXJlL3ZhbGlkYXRvcic7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZUJhY2t1cENvZGVzLFxuXHRnZXRCYWNrdXBDb2Rlc0Zyb21EYXRhYmFzZSxcblx0c2F2ZUJhY2t1cENvZGVzVG9EYXRhYmFzZSxcblx0dmVyaWZ5QmFja3VwQ29kZVxufSBmcm9tICcuL3V0aWxzL2F1dGgvYmFja3VwQ29kZVV0aWwnO1xuaW1wb3J0IHtcblx0Z2VuZXJhdGVFbWFpbDJGQUNvZGUsXG5cdHZlcmlmeUVtYWlsMkZBQ29kZVxufSBmcm9tICcuL3V0aWxzL2F1dGgvZW1haWwyRkFVdGlsJztcbi8vaW1wb3J0IHtcbi8vXHRnZW5lcmF0ZVUyZkF1dGhlbnRpY2F0aW9uT3B0aW9ucyxcbi8vXHRnZW5lcmF0ZVUyZlJlZ2lzdHJhdGlvbk9wdGlvbnMsXG4vL1x0dmVyaWZ5VTJmQXV0aGVudGljYXRpb24sXG4vL1x0dmVyaWZ5VTJmUmVnaXN0cmF0aW9uXG4vLyB9IGZyb20gJy4vdXRpbHMvYXV0aC9maWRvMlV0aWwnO1xuaW1wb3J0IHsgdmVyaWZ5SndUb2tlbiB9IGZyb20gJy4vdXRpbHMvYXV0aC9qd3RVdGlsJztcbi8vIGltcG9ydCB7XG4vLyBcdGdlbmVyYXRlUGFzc2tleUF1dGhlbnRpY2F0aW9uT3B0aW9ucyxcbi8vIFx0Z2VuZXJhdGVQYXNza2V5UmVnaXN0cmF0aW9uT3B0aW9ucyxcbi8vIFx0dmVyaWZ5UGFzc2tleUF1dGhlbnRpY2F0aW9uLFxuLy8gXHR2ZXJpZnlQYXNza2V5UmVnaXN0cmF0aW9uXG4vLyB9IGZyb20gJy4vdXRpbHMvYXV0aC9wYXNza2V5VXRpbCc7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZVl1Ymljb090cE9wdGlvbnMsXG5cdHZhbGlkYXRlWXViaWNvT1RQXG59IGZyb20gJy4vdXRpbHMvYXV0aC95dWJpY29PdHBVdGlsJztcbmltcG9ydCB7XG5cdGdlbmVyYXRlVE9UUFNlY3JldCxcblx0Z2VuZXJhdGVUT1RQVG9rZW4sXG5cdHZlcmlmeVRPVFBUb2tlbixcblx0Z2VuZXJhdGVRUkNvZGVcbn0gZnJvbSAnLi91dGlscy9hdXRoL3RvdHBVdGlsJztcbmltcG9ydCBnZW5lcmF0ZTJGYWN0b3JFbWFpbFRlbXBsYXRlIGZyb20gJy4vdXRpbHMvZW1haWxUZW1wbGF0ZXMvMkZhY3RvckVtYWlsVGVtcGxhdGUnO1xuaW1wb3J0IGdlbmVyYXRlMkZBRW5hYmxlZEVtYWlsVGVtcGxhdGUgZnJvbSAnLi91dGlscy9lbWFpbFRlbXBsYXRlcy8yRkFFbmFibGVkRW1haWxUZW1wbGF0ZSc7XG5pbXBvcnQgZ2VuZXJhdGVBY2NvdW50RGVsZXRlZENvbmZpcm1hdGlvbkVtYWlsVGVtcGxhdGUgZnJvbSAnLi91dGlscy9lbWFpbFRlbXBsYXRlcy9hY2NvdW50RGVsZXRlZENvbmZpcm1hdGlvbkVtYWlsVGVtcGxhdGUnO1xuaW1wb3J0IGdlbmVyYXRlQWNjb3VudERlbGV0aW9uU3RhcnRlZEVtYWlsVGVtcGxhdGUgZnJvbSAnLi91dGlscy9lbWFpbFRlbXBsYXRlcy9hY2NvdW50RGVsZXRpb25TdGFydGVkRW1haWxUZW1wbGF0ZSc7XG5pbXBvcnQgZ2VuZXJhdGVDb25maXJtYXRpb25FbWFpbFRlbXBsYXRlIGZyb20gJy4vdXRpbHMvZW1haWxUZW1wbGF0ZXMvY29uZmlybWF0aW9uRW1haWxUZW1wbGF0ZSc7XG5pbXBvcnQgbG9hZFRlc3RSb3V0ZXMgZnJvbSAnLi91dGlscy90ZXN0L2xvYWRUZXN0Um91dGVzJztcbmltcG9ydCB7IHBhcnNlQm9vbGVhbiB9IGZyb20gJy4vdXRpbHMvcGFyc2VCb29sZWFuJztcblxuZXhwb3J0IHtcblx0YWRkVG9CbGFja2xpc3QsXG5cdGNvbmZpZ3VyZVBhc3Nwb3J0LFxuXHRjcmVhdGVUcmFuc3BvcnRlcixcblx0Y3NyZk1pZGRsZXdhcmUsXG5cdGRlY3J5cHREYXRhRmlsZXMsXG5cdGZlYXR1cmVGbGFncyxcblx0Z2VuZXJhdGUyRmFjdG9yRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGUyRkFFbmFibGVkRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGVBY2NvdW50RGVsZXRlZENvbmZpcm1hdGlvbkVtYWlsVGVtcGxhdGUsXG5cdGdlbmVyYXRlQWNjb3VudERlbGV0aW9uU3RhcnRlZEVtYWlsVGVtcGxhdGUsXG5cdGdlbmVyYXRlQmFja3VwQ29kZXMsXG5cdGdlbmVyYXRlQ29uZmlybWF0aW9uRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGVFbWFpbDJGQUNvZGUsXG5cdC8vIGdlbmVyYXRlUGFzc2tleUF1dGhlbnRpY2F0aW9uT3B0aW9ucyxcblx0Ly8gZ2VuZXJhdGVQYXNza2V5UmVnaXN0cmF0aW9uT3B0aW9ucyxcblx0Z2VuZXJhdGVRUkNvZGUsXG5cdC8vIGdlbmVyYXRlVTJmQXV0aGVudGljYXRpb25PcHRpb25zLFxuXHQvLyBnZW5lcmF0ZVUyZlJlZ2lzdHJhdGlvbk9wdGlvbnMsXG5cdGdlbmVyYXRlVE9UUFNlY3JldCxcblx0Z2VuZXJhdGVUT1RQVG9rZW4sXG5cdGdlbmVyYXRlWXViaWNvT3RwT3B0aW9ucyxcblx0Z2V0QmFja3VwQ29kZXNGcm9tRGF0YWJhc2UsXG5cdGdldFNTTEtleXMsXG5cdGdldFRyYW5zcG9ydGVyLFxuXHRpcEJsYWNrbGlzdE1pZGRsZXdhcmUsXG5cdGluaXRpYWxpemVEYXRhYmFzZSxcblx0aW5pdGlhbGl6ZUlwQmxhY2tsaXN0LFxuXHRsb2FkQmxhY2tsaXN0LFxuXHRsb2FkRW52LFxuXHRsb2FkVGVzdFJvdXRlcyxcblx0bXVsdGVyQ29uZmlndXJlZFVwbG9hZCxcblx0cGFyc2VCb29sZWFuLFxuXHRyYXRlTGltaXRNaWRkbGV3YXJlLFxuXHQvL1x0cmVkaXNDbGllbnQsXG5cdHJlZ2lzdHJhdGlvblZhbGlkYXRpb25SdWxlcyxcblx0cmVtb3ZlRnJvbUJsYWNrbGlzdCxcblx0c2F2ZUJhY2t1cENvZGVzVG9EYXRhYmFzZSxcblx0c2V0dXBIdHRwLFxuXHRzZXR1cFNlY3VyaXR5SGVhZGVycyxcblx0c2xvd2Rvd25NaWRkbGV3YXJlLFxuXHR2YWxpZGF0ZUVudHJ5LFxuXHR2YWxpZGF0ZVl1Ymljb09UUCxcblx0dmVyaWZ5QmFja3VwQ29kZSxcblx0dmVyaWZ5RW1haWwyRkFDb2RlLFxuXHR2ZXJpZnlKd1Rva2VuLFxuXHQvLyB2ZXJpZnlQYXNza2V5QXV0aGVudGljYXRpb24sXG5cdC8vIHZlcmlmeVBhc3NrZXlSZWdpc3RyYXRpb24sXG5cdHZlcmlmeVRPVFBUb2tlbixcblx0Ly8gdmVyaWZ5VTJmQXV0aGVudGljYXRpb24sXG5cdC8vIHZlcmlmeVUyZlJlZ2lzdHJhdGlvbixcblx0X19kaXJuYW1lXG59O1xuXG5jb25zdCB7IGRlY3J5cHREYXRhRmlsZXMsIGdldFNTTEtleXMgfSA9IHNvcHM7XG4iXX0=
