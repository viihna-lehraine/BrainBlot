import { initializeDatabase } from './config/db.js';
import featureFlags from './config/featureFlags.js';
import loadEnv, { __dirname } from './config/loadEnv.js';
import { setupHttp } from './config/http.js';
import { createTransporter, getTransporter } from './config/mailer.js';
import multerConfiguredUpload from './config/multer.js';
import configurePassport from './config/passport.js';
// import redisClient from './config/redis.js';
import setupSecurityHeaders from './middleware/securityHeaders.js';
import slowdownMiddleware from './middleware/slowdown.js';
import { csrfMiddleware } from './middleware/csrf.js';
import sops from './config/sops.js';
import {
	addToBlacklist,
	initializeIpBlacklist,
	ipBlacklistMiddleware,
	loadBlacklist,
	removeFromBlacklist
} from './middleware/ipBlacklist.js';
import { rateLimitMiddleware } from './middleware/rateLimit.js';
import {
	registrationValidationRules,
	validateEntry
} from './middleware/validator.js';
import {
	generateBackupCodes,
	getBackupCodesFromDatabase,
	saveBackupCodesToDatabase,
	verifyBackupCode
} from './utils/auth/backupCodeUtil.js';
import {
	generateEmail2FACode,
	verifyEmail2FACode
} from './utils/auth/email2FAUtil.js';
import {
	generateU2fAuthenticationOptions,
	generateU2fRegistrationOptions,
	verifyU2fAuthentication,
	verifyU2fRegistration
} from './utils/auth/fido2Util.js';
import { verifyJwToken } from './utils/auth/jwtUtil.js';
import {
	generatePasskeyAuthenticationOptions,
	generatePasskeyRegistrationOptions,
	verifyPasskeyAuthentication,
	verifyPasskeyRegistration
} from './utils/auth/passkeyUtil.js';
import {
	generateYubicoOtpOptions,
	validateYubicoOTP
} from './utils/auth/yubicoOtpUtil.js';
import {
	generateTOTPSecret,
	generateTOTPToken,
	verifyTOTPToken,
	generateQRCode
} from './utils/auth/totpUtil.js';
import generate2FactorEmailTemplate from './utils/emailTemplates/2FactorEmailTemplate.js';
import generate2FAEnabledEmailTemplate from './utils/emailTemplates/2FAEnabledEmailTemplate.js';
import generateAccountDeletedConfirmationEmailTemplate from './utils/emailTemplates/accountDeletedConfirmationEmailTemplate.js';
import generateAccountDeletionStartedEmailTemplate from './utils/emailTemplates/accountDeletionStartedEmailTemplate.js';
import generateConfirmationEmailTemplate from './utils/emailTemplates/confirmationEmailTemplate.js';
import loadTestRoutes from './utils/test/loadTestRoutes.js';
import { parseBoolean } from './utils/parseBoolean.js';
export {
	addToBlacklist,
	configurePassport,
	createTransporter,
	csrfMiddleware,
	decryptDataFiles,
	featureFlags,
	generate2FactorEmailTemplate,
	generate2FAEnabledEmailTemplate,
	generateAccountDeletedConfirmationEmailTemplate,
	generateAccountDeletionStartedEmailTemplate,
	generateBackupCodes,
	generateConfirmationEmailTemplate,
	generateEmail2FACode,
	generatePasskeyAuthenticationOptions,
	generatePasskeyRegistrationOptions,
	generateQRCode,
	generateU2fAuthenticationOptions,
	generateU2fRegistrationOptions,
	generateTOTPSecret,
	generateTOTPToken,
	generateYubicoOtpOptions,
	getBackupCodesFromDatabase,
	getSSLKeys,
	getTransporter,
	ipBlacklistMiddleware,
	initializeDatabase,
	initializeIpBlacklist,
	loadBlacklist,
	loadEnv,
	loadTestRoutes,
	multerConfiguredUpload,
	parseBoolean,
	rateLimitMiddleware,
	//	redisClient,
	registrationValidationRules,
	removeFromBlacklist,
	saveBackupCodesToDatabase,
	setupHttp,
	setupSecurityHeaders,
	slowdownMiddleware,
	validateEntry,
	validateYubicoOTP,
	verifyBackupCode,
	verifyEmail2FACode,
	verifyJwToken,
	verifyPasskeyAuthentication,
	verifyPasskeyRegistration,
	verifyTOTPToken,
	verifyU2fAuthentication,
	verifyU2fRegistration,
	__dirname
};
let { decryptDataFiles, getSSLKeys } = sops;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi90cy9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDakQsT0FBTyxZQUFZLE1BQU0sdUJBQXVCLENBQUM7QUFDakQsT0FBTyxPQUFPLEVBQUUsRUFBRSxTQUFTLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUN0RCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzFDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxjQUFjLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNwRSxPQUFPLHNCQUFzQixNQUFNLGlCQUFpQixDQUFDO0FBQ3JELE9BQU8saUJBQWlCLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsNENBQTRDO0FBQzVDLE9BQU8sb0JBQW9CLE1BQU0sOEJBQThCLENBQUM7QUFDaEUsT0FBTyxrQkFBa0IsTUFBTSx1QkFBdUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbkQsT0FBTyxJQUFJLE1BQU0sZUFBZSxDQUFDO0FBQ2pDLE9BQU8sRUFDTixjQUFjLEVBQ2QscUJBQXFCLEVBQ3JCLHFCQUFxQixFQUNyQixhQUFhLEVBQ2IsbUJBQW1CLEVBQ25CLE1BQU0sMEJBQTBCLENBQUM7QUFDbEMsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDN0QsT0FBTyxFQUNOLDJCQUEyQixFQUMzQixhQUFhLEVBQ2IsTUFBTSx3QkFBd0IsQ0FBQztBQUNoQyxPQUFPLEVBQ04sbUJBQW1CLEVBQ25CLDBCQUEwQixFQUMxQix5QkFBeUIsRUFDekIsZ0JBQWdCLEVBQ2hCLE1BQU0sNkJBQTZCLENBQUM7QUFDckMsT0FBTyxFQUNOLG9CQUFvQixFQUNwQixrQkFBa0IsRUFDbEIsTUFBTSwyQkFBMkIsQ0FBQztBQUNuQyxPQUFPLEVBQ04sZ0NBQWdDLEVBQ2hDLDhCQUE4QixFQUM5Qix1QkFBdUIsRUFDdkIscUJBQXFCLEVBQ3JCLE1BQU0sd0JBQXdCLENBQUM7QUFDaEMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBQ3JELE9BQU8sRUFDTixvQ0FBb0MsRUFDcEMsa0NBQWtDLEVBQ2xDLDJCQUEyQixFQUMzQix5QkFBeUIsRUFDekIsTUFBTSwwQkFBMEIsQ0FBQztBQUNsQyxPQUFPLEVBQ04sd0JBQXdCLEVBQ3hCLGlCQUFpQixFQUNqQixNQUFNLDRCQUE0QixDQUFDO0FBQ3BDLE9BQU8sRUFDTixrQkFBa0IsRUFDbEIsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixjQUFjLEVBQ2QsTUFBTSx1QkFBdUIsQ0FBQztBQUMvQixPQUFPLDRCQUE0QixNQUFNLDZDQUE2QyxDQUFDO0FBQ3ZGLE9BQU8sK0JBQStCLE1BQU0sZ0RBQWdELENBQUM7QUFDN0YsT0FBTywrQ0FBK0MsTUFBTSxnRUFBZ0UsQ0FBQztBQUM3SCxPQUFPLDJDQUEyQyxNQUFNLDREQUE0RCxDQUFDO0FBQ3JILE9BQU8saUNBQWlDLE1BQU0sa0RBQWtELENBQUM7QUFDakcsT0FBTyxjQUFjLE1BQU0sNkJBQTZCLENBQUM7QUFDekQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRXBELE9BQU8sRUFDTixjQUFjLEVBQ2QsaUJBQWlCLEVBQ2pCLGlCQUFpQixFQUNqQixjQUFjLEVBQ2QsZ0JBQWdCLEVBQ2hCLFlBQVksRUFDWiw0QkFBNEIsRUFDNUIsK0JBQStCLEVBQy9CLCtDQUErQyxFQUMvQywyQ0FBMkMsRUFDM0MsbUJBQW1CLEVBQ25CLGlDQUFpQyxFQUNqQyxvQkFBb0IsRUFDcEIsb0NBQW9DLEVBQ3BDLGtDQUFrQyxFQUNsQyxjQUFjLEVBQ2QsZ0NBQWdDLEVBQ2hDLDhCQUE4QixFQUM5QixrQkFBa0IsRUFDbEIsaUJBQWlCLEVBQ2pCLHdCQUF3QixFQUN4QiwwQkFBMEIsRUFDMUIsVUFBVSxFQUNWLGNBQWMsRUFDZCxxQkFBcUIsRUFDckIsa0JBQWtCLEVBQ2xCLHFCQUFxQixFQUNyQixhQUFhLEVBQ2IsT0FBTyxFQUNQLGNBQWMsRUFDZCxzQkFBc0IsRUFDdEIsWUFBWSxFQUNaLG1CQUFtQjtBQUNuQixlQUFlO0FBQ2YsMkJBQTJCLEVBQzNCLG1CQUFtQixFQUNuQix5QkFBeUIsRUFDekIsU0FBUyxFQUNULG9CQUFvQixFQUNwQixrQkFBa0IsRUFDbEIsYUFBYSxFQUNiLGlCQUFpQixFQUNqQixnQkFBZ0IsRUFDaEIsa0JBQWtCLEVBQ2xCLGFBQWEsRUFDYiwyQkFBMkIsRUFDM0IseUJBQXlCLEVBQ3pCLGVBQWUsRUFDZix1QkFBdUIsRUFDdkIscUJBQXFCLEVBQ3JCLFNBQVMsRUFDVCxDQUFDO0FBRUYsSUFBSSxFQUFFLGdCQUFnQixFQUFFLFVBQVUsRUFBRSxHQUFHLElBQUksQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluaXRpYWxpemVEYXRhYmFzZSB9IGZyb20gJy4vY29uZmlnL2RiJztcbmltcG9ydCBmZWF0dXJlRmxhZ3MgZnJvbSAnLi9jb25maWcvZmVhdHVyZUZsYWdzJztcbmltcG9ydCBsb2FkRW52LCB7IF9fZGlybmFtZSB9IGZyb20gJy4vY29uZmlnL2xvYWRFbnYnO1xuaW1wb3J0IHsgc2V0dXBIdHRwIH0gZnJvbSAnLi9jb25maWcvaHR0cCc7XG5pbXBvcnQgeyBjcmVhdGVUcmFuc3BvcnRlciwgZ2V0VHJhbnNwb3J0ZXIgfSBmcm9tICcuL2NvbmZpZy9tYWlsZXInO1xuaW1wb3J0IG11bHRlckNvbmZpZ3VyZWRVcGxvYWQgZnJvbSAnLi9jb25maWcvbXVsdGVyJztcbmltcG9ydCBjb25maWd1cmVQYXNzcG9ydCBmcm9tICcuL2NvbmZpZy9wYXNzcG9ydCc7XG4vLyBpbXBvcnQgcmVkaXNDbGllbnQgZnJvbSAnLi9jb25maWcvcmVkaXMnO1xuaW1wb3J0IHNldHVwU2VjdXJpdHlIZWFkZXJzIGZyb20gJy4vbWlkZGxld2FyZS9zZWN1cml0eUhlYWRlcnMnO1xuaW1wb3J0IHNsb3dkb3duTWlkZGxld2FyZSBmcm9tICcuL21pZGRsZXdhcmUvc2xvd2Rvd24nO1xuaW1wb3J0IHsgY3NyZk1pZGRsZXdhcmUgfSBmcm9tICcuL21pZGRsZXdhcmUvY3NyZic7XG5pbXBvcnQgc29wcyBmcm9tICcuL2NvbmZpZy9zb3BzJztcbmltcG9ydCB7XG5cdGFkZFRvQmxhY2tsaXN0LFxuXHRpbml0aWFsaXplSXBCbGFja2xpc3QsXG5cdGlwQmxhY2tsaXN0TWlkZGxld2FyZSxcblx0bG9hZEJsYWNrbGlzdCxcblx0cmVtb3ZlRnJvbUJsYWNrbGlzdFxufSBmcm9tICcuL21pZGRsZXdhcmUvaXBCbGFja2xpc3QnO1xuaW1wb3J0IHsgcmF0ZUxpbWl0TWlkZGxld2FyZSB9IGZyb20gJy4vbWlkZGxld2FyZS9yYXRlTGltaXQnO1xuaW1wb3J0IHtcblx0cmVnaXN0cmF0aW9uVmFsaWRhdGlvblJ1bGVzLFxuXHR2YWxpZGF0ZUVudHJ5XG59IGZyb20gJy4vbWlkZGxld2FyZS92YWxpZGF0b3InO1xuaW1wb3J0IHtcblx0Z2VuZXJhdGVCYWNrdXBDb2Rlcyxcblx0Z2V0QmFja3VwQ29kZXNGcm9tRGF0YWJhc2UsXG5cdHNhdmVCYWNrdXBDb2Rlc1RvRGF0YWJhc2UsXG5cdHZlcmlmeUJhY2t1cENvZGVcbn0gZnJvbSAnLi91dGlscy9hdXRoL2JhY2t1cENvZGVVdGlsJztcbmltcG9ydCB7XG5cdGdlbmVyYXRlRW1haWwyRkFDb2RlLFxuXHR2ZXJpZnlFbWFpbDJGQUNvZGVcbn0gZnJvbSAnLi91dGlscy9hdXRoL2VtYWlsMkZBVXRpbCc7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZVUyZkF1dGhlbnRpY2F0aW9uT3B0aW9ucyxcblx0Z2VuZXJhdGVVMmZSZWdpc3RyYXRpb25PcHRpb25zLFxuXHR2ZXJpZnlVMmZBdXRoZW50aWNhdGlvbixcblx0dmVyaWZ5VTJmUmVnaXN0cmF0aW9uXG59IGZyb20gJy4vdXRpbHMvYXV0aC9maWRvMlV0aWwnO1xuaW1wb3J0IHsgdmVyaWZ5SndUb2tlbiB9IGZyb20gJy4vdXRpbHMvYXV0aC9qd3RVdGlsJztcbmltcG9ydCB7XG5cdGdlbmVyYXRlUGFzc2tleUF1dGhlbnRpY2F0aW9uT3B0aW9ucyxcblx0Z2VuZXJhdGVQYXNza2V5UmVnaXN0cmF0aW9uT3B0aW9ucyxcblx0dmVyaWZ5UGFzc2tleUF1dGhlbnRpY2F0aW9uLFxuXHR2ZXJpZnlQYXNza2V5UmVnaXN0cmF0aW9uXG59IGZyb20gJy4vdXRpbHMvYXV0aC9wYXNza2V5VXRpbCc7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZVl1Ymljb090cE9wdGlvbnMsXG5cdHZhbGlkYXRlWXViaWNvT1RQXG59IGZyb20gJy4vdXRpbHMvYXV0aC95dWJpY29PdHBVdGlsJztcbmltcG9ydCB7XG5cdGdlbmVyYXRlVE9UUFNlY3JldCxcblx0Z2VuZXJhdGVUT1RQVG9rZW4sXG5cdHZlcmlmeVRPVFBUb2tlbixcblx0Z2VuZXJhdGVRUkNvZGVcbn0gZnJvbSAnLi91dGlscy9hdXRoL3RvdHBVdGlsJztcbmltcG9ydCBnZW5lcmF0ZTJGYWN0b3JFbWFpbFRlbXBsYXRlIGZyb20gJy4vdXRpbHMvZW1haWxUZW1wbGF0ZXMvMkZhY3RvckVtYWlsVGVtcGxhdGUnO1xuaW1wb3J0IGdlbmVyYXRlMkZBRW5hYmxlZEVtYWlsVGVtcGxhdGUgZnJvbSAnLi91dGlscy9lbWFpbFRlbXBsYXRlcy8yRkFFbmFibGVkRW1haWxUZW1wbGF0ZSc7XG5pbXBvcnQgZ2VuZXJhdGVBY2NvdW50RGVsZXRlZENvbmZpcm1hdGlvbkVtYWlsVGVtcGxhdGUgZnJvbSAnLi91dGlscy9lbWFpbFRlbXBsYXRlcy9hY2NvdW50RGVsZXRlZENvbmZpcm1hdGlvbkVtYWlsVGVtcGxhdGUnO1xuaW1wb3J0IGdlbmVyYXRlQWNjb3VudERlbGV0aW9uU3RhcnRlZEVtYWlsVGVtcGxhdGUgZnJvbSAnLi91dGlscy9lbWFpbFRlbXBsYXRlcy9hY2NvdW50RGVsZXRpb25TdGFydGVkRW1haWxUZW1wbGF0ZSc7XG5pbXBvcnQgZ2VuZXJhdGVDb25maXJtYXRpb25FbWFpbFRlbXBsYXRlIGZyb20gJy4vdXRpbHMvZW1haWxUZW1wbGF0ZXMvY29uZmlybWF0aW9uRW1haWxUZW1wbGF0ZSc7XG5pbXBvcnQgbG9hZFRlc3RSb3V0ZXMgZnJvbSAnLi91dGlscy90ZXN0L2xvYWRUZXN0Um91dGVzJztcbmltcG9ydCB7IHBhcnNlQm9vbGVhbiB9IGZyb20gJy4vdXRpbHMvcGFyc2VCb29sZWFuJztcblxuZXhwb3J0IHtcblx0YWRkVG9CbGFja2xpc3QsXG5cdGNvbmZpZ3VyZVBhc3Nwb3J0LFxuXHRjcmVhdGVUcmFuc3BvcnRlcixcblx0Y3NyZk1pZGRsZXdhcmUsXG5cdGRlY3J5cHREYXRhRmlsZXMsXG5cdGZlYXR1cmVGbGFncyxcblx0Z2VuZXJhdGUyRmFjdG9yRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGUyRkFFbmFibGVkRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGVBY2NvdW50RGVsZXRlZENvbmZpcm1hdGlvbkVtYWlsVGVtcGxhdGUsXG5cdGdlbmVyYXRlQWNjb3VudERlbGV0aW9uU3RhcnRlZEVtYWlsVGVtcGxhdGUsXG5cdGdlbmVyYXRlQmFja3VwQ29kZXMsXG5cdGdlbmVyYXRlQ29uZmlybWF0aW9uRW1haWxUZW1wbGF0ZSxcblx0Z2VuZXJhdGVFbWFpbDJGQUNvZGUsXG5cdGdlbmVyYXRlUGFzc2tleUF1dGhlbnRpY2F0aW9uT3B0aW9ucyxcblx0Z2VuZXJhdGVQYXNza2V5UmVnaXN0cmF0aW9uT3B0aW9ucyxcblx0Z2VuZXJhdGVRUkNvZGUsXG5cdGdlbmVyYXRlVTJmQXV0aGVudGljYXRpb25PcHRpb25zLFxuXHRnZW5lcmF0ZVUyZlJlZ2lzdHJhdGlvbk9wdGlvbnMsXG5cdGdlbmVyYXRlVE9UUFNlY3JldCxcblx0Z2VuZXJhdGVUT1RQVG9rZW4sXG5cdGdlbmVyYXRlWXViaWNvT3RwT3B0aW9ucyxcblx0Z2V0QmFja3VwQ29kZXNGcm9tRGF0YWJhc2UsXG5cdGdldFNTTEtleXMsXG5cdGdldFRyYW5zcG9ydGVyLFxuXHRpcEJsYWNrbGlzdE1pZGRsZXdhcmUsXG5cdGluaXRpYWxpemVEYXRhYmFzZSxcblx0aW5pdGlhbGl6ZUlwQmxhY2tsaXN0LFxuXHRsb2FkQmxhY2tsaXN0LFxuXHRsb2FkRW52LFxuXHRsb2FkVGVzdFJvdXRlcyxcblx0bXVsdGVyQ29uZmlndXJlZFVwbG9hZCxcblx0cGFyc2VCb29sZWFuLFxuXHRyYXRlTGltaXRNaWRkbGV3YXJlLFxuXHQvL1x0cmVkaXNDbGllbnQsXG5cdHJlZ2lzdHJhdGlvblZhbGlkYXRpb25SdWxlcyxcblx0cmVtb3ZlRnJvbUJsYWNrbGlzdCxcblx0c2F2ZUJhY2t1cENvZGVzVG9EYXRhYmFzZSxcblx0c2V0dXBIdHRwLFxuXHRzZXR1cFNlY3VyaXR5SGVhZGVycyxcblx0c2xvd2Rvd25NaWRkbGV3YXJlLFxuXHR2YWxpZGF0ZUVudHJ5LFxuXHR2YWxpZGF0ZVl1Ymljb09UUCxcblx0dmVyaWZ5QmFja3VwQ29kZSxcblx0dmVyaWZ5RW1haWwyRkFDb2RlLFxuXHR2ZXJpZnlKd1Rva2VuLFxuXHR2ZXJpZnlQYXNza2V5QXV0aGVudGljYXRpb24sXG5cdHZlcmlmeVBhc3NrZXlSZWdpc3RyYXRpb24sXG5cdHZlcmlmeVRPVFBUb2tlbixcblx0dmVyaWZ5VTJmQXV0aGVudGljYXRpb24sXG5cdHZlcmlmeVUyZlJlZ2lzdHJhdGlvbixcblx0X19kaXJuYW1lXG59O1xuXG5sZXQgeyBkZWNyeXB0RGF0YUZpbGVzLCBnZXRTU0xLZXlzIH0gPSBzb3BzO1xuIl19
