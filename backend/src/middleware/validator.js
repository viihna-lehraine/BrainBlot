import validator from 'validator';
export const validateEntry = (req, res, next) => {
	const errors = [];
	// Name validation
	if (validator.isEmpty(req.body.name || '')) {
		errors.push({ msg: 'Name is required', param: 'name' });
	}
	// Message validation
	if (validator.isEmpty(req.body.message || '')) {
		errors.push({ msg: 'Message is required', param: 'message' });
	}
	if (errors.length) {
		return res.status(400).json({ errors });
	}
	return next;
};
export const registrationValidationRules = (req, res, next) => {
	const errors = [];
	// Username validation
	if (!validator.isLength(req.body.username || '', { min: 3 })) {
		errors.push({
			msg: 'Username must be at least 3 characters long',
			param: 'username'
		});
	}
	if (!validator.matches(req.body.username || '', /^[a-zA-Z0-9_-]+$/)) {
		errors.push({
			msg: 'Username can only contain letters, numbers, underscores, and dashes',
			param: 'username'
		});
	}
	// Email validation
	if (!validator.isEmail(req.body.email || '')) {
		errors.push({
			msg: 'Please provide a valid email address',
			param: 'email'
		});
	}
	// Password validation
	if (!validator.isLength(req.body.password || '', { min: 8 })) {
		errors.push({
			msg: 'Password must be at least 8 characters long',
			param: 'password'
		});
	}
	if (!validator.matches(req.body.password || '', /[A-Z]/)) {
		errors.push({
			msg: 'Password must contain at least one uppercase letter',
			param: 'password'
		});
	}
	if (!validator.matches(req.body.password || '', /[a-z]/)) {
		errors.push({
			msg: 'Password must contain at least one lowercase letter',
			param: 'password'
		});
	}
	if (!validator.matches(req.body.password || '', /\d/)) {
		errors.push({
			msg: 'Password must contain at least one number',
			param: 'password'
		});
	}
	if (!validator.matches(req.body.password || '', /[^A-Za-z0-9]/)) {
		errors.push({
			msg: 'Password must contain at least one special character',
			param: 'password'
		});
	}
	// Confirm password validation
	if (req.body.password !== req.body.confirmPassword) {
		errors.push({
			msg: 'Passwords do not match',
			param: 'confirmPassword'
		});
	}
	if (errors.length) {
		res.status(400).json({ errors });
		return;
	}
	next();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vdHMvbWlkZGxld2FyZS92YWxpZGF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxTQUFTLE1BQU0sV0FBVyxDQUFDO0FBRWxDLE1BQU0sQ0FBQyxNQUFNLGFBQWEsR0FBRyxDQUM1QixHQUFZLEVBQ1osR0FBYSxFQUNiLElBQWtCLEVBQ2pCLEVBQUU7SUFDSCxNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUM7SUFFbEIsa0JBQWtCO0lBQ2xCLElBQUksU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQzVDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLEVBQUUsa0JBQWtCLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUVELHFCQUFxQjtJQUNyQixJQUFJLFNBQVMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQztRQUMvQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLHFCQUFxQixFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDO0lBQy9ELENBQUM7SUFFRCxJQUFJLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNuQixPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBRUQsT0FBTyxJQUFJLENBQUM7QUFDYixDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSwyQkFBMkIsR0FBRyxDQUMxQyxHQUFZLEVBQ1osR0FBYSxFQUNiLElBQWtCLEVBQ2pCLEVBQUU7SUFDSCxNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUM7SUFF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QUUsQ0FBQztRQUNuQixHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDakMsT0FBTztJQUNSLENBQUM7SUFFRCxJQUFJLEVBQUUsQ0FBQztBQUNSLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRGdW5jdGlvbiwgUmVxdWVzdCwgUmVzcG9uc2UgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCB2YWxpZGF0b3IgZnJvbSAndmFsaWRhdG9yJztcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlRW50cnkgPSAoXG5cdHJlcTogUmVxdWVzdCxcblx0cmVzOiBSZXNwb25zZSxcblx0bmV4dDogTmV4dEZ1bmN0aW9uXG4pID0+IHtcblx0Y29uc3QgZXJyb3JzID0gW107XG5cblx0Ly8gTmFtZSB2YWxpZGF0aW9uXG5cdGlmICh2YWxpZGF0b3IuaXNFbXB0eShyZXEuYm9keS5uYW1lIHx8ICcnKSkge1xuXHRcdGVycm9ycy5wdXNoKHsgbXNnOiAnTmFtZSBpcyByZXF1aXJlZCcsIHBhcmFtOiAnbmFtZScgfSk7XG5cdH1cblxuXHQvLyBNZXNzYWdlIHZhbGlkYXRpb25cblx0aWYgKHZhbGlkYXRvci5pc0VtcHR5KHJlcS5ib2R5Lm1lc3NhZ2UgfHwgJycpKSB7XG5cdFx0ZXJyb3JzLnB1c2goeyBtc2c6ICdNZXNzYWdlIGlzIHJlcXVpcmVkJywgcGFyYW06ICdtZXNzYWdlJyB9KTtcblx0fVxuXG5cdGlmIChlcnJvcnMubGVuZ3RoKSB7XG5cdFx0cmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3JzIH0pO1xuXHR9XG5cblx0cmV0dXJuIG5leHQ7XG59O1xuXG5leHBvcnQgY29uc3QgcmVnaXN0cmF0aW9uVmFsaWRhdGlvblJ1bGVzID0gKFxuXHRyZXE6IFJlcXVlc3QsXG5cdHJlczogUmVzcG9uc2UsXG5cdG5leHQ6IE5leHRGdW5jdGlvblxuKSA9PiB7XG5cdGNvbnN0IGVycm9ycyA9IFtdO1xuXG5cdC8vIFVzZXJuYW1lIHZhbGlkYXRpb25cblx0aWYgKCF2YWxpZGF0b3IuaXNMZW5ndGgocmVxLmJvZHkudXNlcm5hbWUgfHwgJycsIHsgbWluOiAzIH0pKSB7XG5cdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0bXNnOiAnVXNlcm5hbWUgbXVzdCBiZSBhdCBsZWFzdCAzIGNoYXJhY3RlcnMgbG9uZycsXG5cdFx0XHRwYXJhbTogJ3VzZXJuYW1lJ1xuXHRcdH0pO1xuXHR9XG5cdGlmICghdmFsaWRhdG9yLm1hdGNoZXMocmVxLmJvZHkudXNlcm5hbWUgfHwgJycsIC9eW2EtekEtWjAtOV8tXSskLykpIHtcblx0XHRlcnJvcnMucHVzaCh7XG5cdFx0XHRtc2c6ICdVc2VybmFtZSBjYW4gb25seSBjb250YWluIGxldHRlcnMsIG51bWJlcnMsIHVuZGVyc2NvcmVzLCBhbmQgZGFzaGVzJyxcblx0XHRcdHBhcmFtOiAndXNlcm5hbWUnXG5cdFx0fSk7XG5cdH1cblxuXHQvLyBFbWFpbCB2YWxpZGF0aW9uXG5cdGlmICghdmFsaWRhdG9yLmlzRW1haWwocmVxLmJvZHkuZW1haWwgfHwgJycpKSB7XG5cdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0bXNnOiAnUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJyxcblx0XHRcdHBhcmFtOiAnZW1haWwnXG5cdFx0fSk7XG5cdH1cblxuXHQvLyBQYXNzd29yZCB2YWxpZGF0aW9uXG5cdGlmICghdmFsaWRhdG9yLmlzTGVuZ3RoKHJlcS5ib2R5LnBhc3N3b3JkIHx8ICcnLCB7IG1pbjogOCB9KSkge1xuXHRcdGVycm9ycy5wdXNoKHtcblx0XHRcdG1zZzogJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzIGxvbmcnLFxuXHRcdFx0cGFyYW06ICdwYXNzd29yZCdcblx0XHR9KTtcblx0fVxuXHRpZiAoIXZhbGlkYXRvci5tYXRjaGVzKHJlcS5ib2R5LnBhc3N3b3JkIHx8ICcnLCAvW0EtWl0vKSkge1xuXHRcdGVycm9ycy5wdXNoKHtcblx0XHRcdG1zZzogJ1Bhc3N3b3JkIG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgdXBwZXJjYXNlIGxldHRlcicsXG5cdFx0XHRwYXJhbTogJ3Bhc3N3b3JkJ1xuXHRcdH0pO1xuXHR9XG5cdGlmICghdmFsaWRhdG9yLm1hdGNoZXMocmVxLmJvZHkucGFzc3dvcmQgfHwgJycsIC9bYS16XS8pKSB7XG5cdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0bXNnOiAnUGFzc3dvcmQgbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSBsb3dlcmNhc2UgbGV0dGVyJyxcblx0XHRcdHBhcmFtOiAncGFzc3dvcmQnXG5cdFx0fSk7XG5cdH1cblx0aWYgKCF2YWxpZGF0b3IubWF0Y2hlcyhyZXEuYm9keS5wYXNzd29yZCB8fCAnJywgL1xcZC8pKSB7XG5cdFx0ZXJyb3JzLnB1c2goe1xuXHRcdFx0bXNnOiAnUGFzc3dvcmQgbXVzdCBjb250YWluIGF0IGxlYXN0IG9uZSBudW1iZXInLFxuXHRcdFx0cGFyYW06ICdwYXNzd29yZCdcblx0XHR9KTtcblx0fVxuXHRpZiAoIXZhbGlkYXRvci5tYXRjaGVzKHJlcS5ib2R5LnBhc3N3b3JkIHx8ICcnLCAvW15BLVphLXowLTldLykpIHtcblx0XHRlcnJvcnMucHVzaCh7XG5cdFx0XHRtc2c6ICdQYXNzd29yZCBtdXN0IGNvbnRhaW4gYXQgbGVhc3Qgb25lIHNwZWNpYWwgY2hhcmFjdGVyJyxcblx0XHRcdHBhcmFtOiAncGFzc3dvcmQnXG5cdFx0fSk7XG5cdH1cblxuXHQvLyBDb25maXJtIHBhc3N3b3JkIHZhbGlkYXRpb25cblx0aWYgKHJlcS5ib2R5LnBhc3N3b3JkICE9PSByZXEuYm9keS5jb25maXJtUGFzc3dvcmQpIHtcblx0XHRlcnJvcnMucHVzaCh7XG5cdFx0XHRtc2c6ICdQYXNzd29yZHMgZG8gbm90IG1hdGNoJyxcblx0XHRcdHBhcmFtOiAnY29uZmlybVBhc3N3b3JkJ1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKGVycm9ycy5sZW5ndGgpIHtcblx0XHRyZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9ycyB9KTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRuZXh0KCk7XG59O1xuIl19
