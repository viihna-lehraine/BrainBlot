import { __awaiter } from 'tslib';
import { verifyJwToken } from '../utils/auth/jwtUtil.js';
export const authenticateJwT = (req, res, next) =>
	__awaiter(void 0, void 0, void 0, function* () {
		var _a;
		const token =
			(_a = req.headers.authorization) === null || _a === void 0
				? void 0
				: _a.split(' ')[1];
		if (!token) {
			res.sendStatus(403);
			return;
		}
		const user = yield verifyJwToken(token);
		if (!user) {
			res.sendStatus(403);
			return;
		}
		req.user = user;
		next();
	});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiand0QXV0aE1pZGRsZXdhcmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi90cy9taWRkbGV3YXJlL2p3dEF1dGhNaWRkbGV3YXJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFdEQsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFHLENBQzlCLEdBQVksRUFDWixHQUFhLEVBQ2IsSUFBa0IsRUFDRixFQUFFOztJQUNsQixNQUFNLEtBQUssR0FBRyxNQUFBLEdBQUcsQ0FBQyxPQUFPLENBQUMsYUFBYSwwQ0FBRSxLQUFLLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBRXZELElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNaLEdBQUcsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEIsT0FBTztJQUNSLENBQUM7SUFFRCxNQUFNLElBQUksR0FBRyxNQUFNLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUV4QyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDWCxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BCLE9BQU87SUFDUixDQUFDO0lBRUQsR0FBRyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7SUFDaEIsSUFBSSxFQUFFLENBQUM7QUFDUixDQUFDLENBQUEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRGdW5jdGlvbiwgUmVxdWVzdCwgUmVzcG9uc2UgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCB7IHZlcmlmeUp3VG9rZW4gfSBmcm9tICcuLi91dGlscy9hdXRoL2p3dFV0aWwnO1xuXG5leHBvcnQgY29uc3QgYXV0aGVudGljYXRlSndUID0gYXN5bmMgKFxuXHRyZXE6IFJlcXVlc3QsXG5cdHJlczogUmVzcG9uc2UsXG5cdG5leHQ6IE5leHRGdW5jdGlvblxuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG5cdGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8uc3BsaXQoJyAnKVsxXTtcblxuXHRpZiAoIXRva2VuKSB7XG5cdFx0cmVzLnNlbmRTdGF0dXMoNDAzKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB1c2VyID0gYXdhaXQgdmVyaWZ5SndUb2tlbih0b2tlbik7XG5cblx0aWYgKCF1c2VyKSB7XG5cdFx0cmVzLnNlbmRTdGF0dXMoNDAzKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRyZXEudXNlciA9IHVzZXI7XG5cdG5leHQoKTtcbn07XG4iXX0=
